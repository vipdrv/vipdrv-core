function openShortcodeGenerator(a){var b,c="#"+a.parent().parent().find(".wp-editor-area").attr("id");window.cursorPosition=0,window.editorArea=c,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.isTinyMceActive()?window.SCmoduleContentEditorMode="tinymce":window.SCmoduleContentEditorMode="html","tinymce"!==window.SCmoduleContentEditorMode&&(window.cursorPosition=jQuery(c).getCursorPosition()),b=new FusionPageBuilder.ModalView({model:this.model,collection:FusionPageBuilderElements,attributes:{"data-modal_view":"all_elements_generator"},view:this}),jQuery("body").append(b.render().el)}var FusionPageBuilder=FusionPageBuilder||{};!function(a){FusionPageBuilder.template=_.memoize(function(a){var b,c={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(d){return(b=b||_.template(a,null,c))(d)}})}(jQuery),function(a,b){"undefined"!=typeof module&&module.exports?module.exports=b():"function"==typeof define?define(b):this.fusionBuilderStickyHeader=b()}(0,function(){return function(a,b){function c(a){var b,c,e=a.getBoundingClientRect(),f=d();return c=e.top+f.top,jQuery(a).parents("#fusion_builder_layout").hasClass("closed")&&(b=jQuery(a).parents("#fusion_builder_layout").find(".ui-sortable-handle")[0].getBoundingClientRect(),c=b.top+b.height+f.top),{left:e.left+f.left,top:c,width:e.width,height:e.height}}function d(){return{top:window.pageYOffset||document.documentElement.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft}}var e,f,g=document.getElementById("fusion_builder_container"),h=b||0,i=c(a),j={position:"fixed",top:h+"px",left:i.left+"px",width:i.width+"px","border-top":"22px solid #ffffff","z-index":999},k=["position","top","left","z-index","border-top"],l={};k.forEach(function(b){l[b]=a.style[b],l.width="100%"}),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),window.onscroll&&(e=window.onscroll),window.onresize&&(f=window.onresize),window.onscroll=function(b){var f,k,m,n=document.getElementById("fusion_builder_main_container"),o=c(n),p=jQuery("#fusion_builder_controls").height(),q="fixed"===jQuery("#fusion_builder_controls").css("position")?o.height+i.height-p:o.height;if(jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),d().top>i.top-h-22&&d().top+h+22+i.height<o.top+q){f=g,k=f.left+"px",j.left=k,j.width=jQuery("#fusion_builder_container").outerWidth()+"px";for(m in j)a.style[m]=j[m]}else for(m in l)a.style[m]=l[m];e&&e(b)},window.onresize=function(b){var c=jQuery("#fusion_builder_container").outerWidth()+"px";jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),d().top>i.top-h?a.style.width=c:a.style.width=l.width,f&&f(b)}}});var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.Element=Backbone.Model.extend({defaults:{type:"element"},initialize:function(){}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){var a=[],b=[];_.each(fusionAllElements,function(b){var c;void 0===b.hide_from_builder&&void 0===b.generator_only&&(c={title:b.name,label:b.shortcode},a.push(c))}),_.each(fusionAllElements,function(a){var c;void 0===a.hide_from_builder&&(c={title:a.name,label:a.shortcode},b.push(c))}),a.sort(function(a,b){var c=a.title.toLowerCase(),d=b.title.toLowerCase();return c<d?-1:c>d?1:0}),b.sort(function(a,b){var c=a.title.toLowerCase(),d=b.title.toLowerCase();return c<d?-1:c>d?1:0}),FusionPageBuilder.ViewManager=Backbone.Model.extend({defaults:{modules:a,generator_elements:b,elementCount:0,views:{}},initialize:function(){},getView:function(a){return this.get("views")[a]},getChildViews:function(a){var b=this.get("views"),c={};return _.each(b,function(b,d){a===b.model.attributes.parent&&(c[d]=b)}),c},generateCid:function(){var a=this.get("elementCount")+1;return this.set({elementCount:a}),a},addView:function(a,b){var c=this.get("views");c[a]=b,this.set({views:c})},removeView:function(a){var b=this.get("views"),c={};_.each(b,function(b,d){d!=a&&(c[d]=b)}),this.set({views:c})},removeViews:function(a){var b={};this.set({views:b})},countElementsByType:function(a){var b=this.get("views"),c=0;return _.each(b,function(b){b.model.attributes.type===a&&c++}),c}}),FusionPageBuilderViewManager=new FusionPageBuilder.ViewManager})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.Collection=Backbone.Collection.extend({model:FusionPageBuilder.Element}),FusionPageBuilderElements=new FusionPageBuilder.Collection})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.ElementView=window.wp.Backbone.View.extend({className:"fusion_module_block fusion_builder_column_element",template:FusionPageBuilder.template(a("#fusion-builder-block-module-template").html()),events:{"click .fusion-builder-settings":"showSettings","click .fusion-builder-clone-module":"cloneElement","click .fusion-builder-remove":"removeElement","click .fusion-builder-save-module-dialog":"saveElementDialog"},initialize:function(){this.elementIsCloning=!1},render:function(){return this.$el.html(this.template(this.model.attributes)),this},saveElementDialog:function(b){b&&b.preventDefault(),FusionPageBuilderApp.showLibrary(),a("#fusion-builder-layouts-elements-trigger").click(),a("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div>")},saveElement:function(b){var c=(this.$el,this.getElementContent()),d=a("#fusion-builder-save-element-input").val(),e=a("#fusion-builder-layouts-elements .fusion-page-layouts"),f=a("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message");b&&b.preventDefault(),!0!==FusionPageBuilderApp.layoutIsSaving&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==d?a.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:d,fusion_layout_content:c,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements"},complete:function(b){FusionPageBuilderApp.layoutIsSaving=!1,e.prepend(b.responseText),a(".fusion-save-element-fields").remove(),f.hide()}}):alert(fusionBuilderText.please_enter_element_name))},getElementContent:function(){return FusionPageBuilderApp.generateElementShortcode(this.$el,!1)},removeElement:function(a){a&&a.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),a&&(fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.deleted+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-removed"))},cloneElement:function(b,c){var d;b&&b.preventDefault(),!0!==this.elementIsCloning&&(this.elementIsCloning=!0,d=a.extend(!0,{},this.model.attributes),d.created="manually",d.cid=FusionPageBuilderViewManager.generateCid(),d.targetElement=this.$el,"undefined"!==d.from&&delete d.from,c&&(d.parent=c),FusionPageBuilderApp.collection.add(d),c||(fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.cloned+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.elementIsCloning=!1,b&&FusionPageBuilderEvents.trigger("fusion-element-cloned"))},showSettings:function(b){var c,d={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};b&&b.preventDefault(),c=new FusionPageBuilder.ModalView(d),a("body").append(c.render().el)}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.ElementPreviewView=window.wp.Backbone.View.extend({className:"fusion_module_block_preview ",initialize:function(){this.template=FusionPageBuilder.template(a("#"+fusionAllElements[this.model.attributes.element_type].preview_id).html())},render:function(){return this.$el.html(this.template(this.model.attributes)),this}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.ElementLibraryView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(a("#fusion-builder-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns"},initialize:function(a){this.options=a,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),FusionPageBuilderApp.showSavedElements("elements",this.$el.find("#custom-elements")),"true"===FusionPageBuilderApp.innerColumn&&this.$el.addClass("fusion-add-to-nested"),this},addCustomModule:function(b){var c,d;b&&b.preventDefault(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,c=a(b.currentTarget).closest("li").data("layout_id"),d=a(b.currentTarget).find(".fusion_module_title").text(),a(b.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),a(b.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),a.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_id:c},success:function(c){var d=JSON.parse(c);FusionPageBuilderApp.shortcodesToBuilder(d.post_content,FusionPageBuilderApp.parentColumnId),FusionPageBuilderApp.layoutIsLoading=!1,a(b.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),a(b.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide()},complete:function(){fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.added_custom_element+d,FusionPageBuilderEvents.trigger("fusion-element-added")}}))},addModule:function(b){var c,d,e,f,g,h,i;b&&b.preventDefault(),c=a(b.currentTarget),d=c.find(".fusion_module_label").text(),d in fusionAllElements?(e=fusionAllElements[d].params,f=fusionAllElements[d].multi,g=fusionAllElements[d].shortcode,h=fusionAllElements[d].name,i=fusionAllElements[d].allow_generator):(e="",f="",g="",i=""),b&&(fusionHistoryState=fusionBuilderText.added+" "+h+" "+fusionBuilderText.element),this.collection.add([{type:"element",added:"manually",cid:FusionPageBuilderViewManager.generateCid(),element_type:g,params:e,parent:this.attributes["data-parent_cid"],view:this.options.view,allow_generator:i,multi:f}]),this.remove(),FusionPageBuilderEvents.trigger("fusion-element-added")},addNestedColumns:function(b,c){var d,e,f,g,h,i,j,k;b&&b.preventDefault(),d=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_row_inner",element_type:"fusion_builder_row_inner",cid:d,parent:this.model.get("cid"),view:this,appendAfter:c}]),FusionPageBuilderApp.activeModal="column",e=this,f=a(b.target).is("li")?a(b.target):a(b.target).closest("li"),g=f.data("layout").split(","),_.size(g),h=this.options.view,i=fusionAllElements.fusion_builder_column_inner.params,j={},_.each(i,function(a){k=_.isObject(a.value)?a.default:a.value,j[a.param_name]=k}),_.each(g,function(a,b){var c={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:d,layout:a,view:h,params:j};e.collection.add([c])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),b&&(fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.GeneratorElementsView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(a("#fusion-builder-generator-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addElement","click .fusion-builder-column-layouts .generator-column":"addColumns","click .fusion-builder-column-layouts .generator-section":"addContainer"},initialize:function(a){this.options=a,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),this},addElement:function(b){var c,d,e,f,g,h,i,j;b&&b.preventDefault(),c=a(b.currentTarget),c.find(".fusion_module_title").text(),d=c.find(".fusion_module_label").text(),d in fusionAllElements?(f=fusionAllElements[d].multi,g=fusionAllElements[d].shortcode):(e="",f="",g=""),i=a.extend(!0,{},fusionAllElements[d].params),e={},_.each(i,function(a){var b;b=_.isObject(a.value)?a.default:a.value,e[a.param_name]=b}),j={type:"generated_element",added:"manually",element_type:g,params:e,view:this.options.view,multi:f,cid:FusionPageBuilderViewManager.generateCid()},"undefined"!==e.element_content&&"undefined"!=typeof tinyMCE&&"undefined"!==tinyMCE.activeEditor&&void 0===f&&window.tinyMCE.activeEditor&&(h=window.tinyMCE.activeEditor.selection.getContent())&&(j.params.element_content=h,window.tinyMCE.activeEditor.selection.setContent(""),h="",delete j.added),this.collection.add(j),this.remove()},addColumns:function(b){var c,d,e,f,g,h,i,j,k="[fusion_builder_row_inner]",l="fusion_builder_column_inner",m="[/fusion_builder_row_inner]";!FusionPageBuilderApp.builderActive&&jQuery(b.target).parents("#builder-regular-columns").length&&(k="",l="fusion_builder_column",m=""),b&&b.preventDefault(),FusionPageBuilderApp.activeModal="column",c=this,d=a(b.target).is("li")?a(b.target):a(b.target).closest("li"),e=d.data("layout").split(","),_.size(e),f=this.options.view,g=fusionAllElements[l].params,h={},_.each(g,function(a){i=_.isObject(a.value)?a.default:a.value,h[a.param_name]=i}),_.each(e,function(a,b){var d;h.type=a,d={type:"generated_element",added:"manually",element_type:l,layout:a,view:f,params:h},j=c.collection.add(d),k+=FusionPageBuilderApp.generateElementShortcode(j,!1,!0)}),k+=m,fusionBuilderInsertIntoEditor(k,FusionPageBuilderApp.shortcodeGeneratorEditorID),FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID="",this.remove()},addContainer:function(a){var b,c,d;a&&a.preventDefault(),FusionPageBuilderApp.activeModal="container",FusionPageBuilderViewManager.generateCid(),b=fusionAllElements.fusion_builder_container.params,c={},_.each(b,function(a){d=_.isObject(a.value)?a.default:a.value,c[a.param_name]=d}),this.collection.add([{type:"generated_element",added:"manually",element_type:"fusion_builder_container",params:c,view:this}])}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.ContainerView=window.wp.Backbone.View.extend({className:"fusion_builder_container",template:FusionPageBuilder.template(a("#fusion-builder-container-template").html()),events:{"click .fusion-builder-clone-container":"cloneContainer","click .fusion-builder-remove":"removeContainer","click .fusion-builder-section-add":"addContainer","click .fusion-builder-toggle":"toggleContainer","click .fusion-builder-settings-container":"showSettings","paste .fusion-builder-section-name":"renameContainer","keydown .fusion-builder-section-name":"renameContainer","click .fusion-builder-save-element":"saveElementDialog"},initialize:function(){this.typingTimer,this.doneTypingInterval=800},render:function(){return this.$el.html(this.template(this.model.toJSON())),void 0!==this.model.attributes.params.admin_toggled&&"yes"===this.model.attributes.params.admin_toggled&&(this.$el.addClass("fusion-builder-section-folded"),this.$el.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")),this},saveElement:function(b){var c=(this.$el,this.getContainerContent()),d=a("#fusion-builder-save-element-input").val(),e=a("#fusion-builder-layouts-sections .fusion-page-layouts"),f=a("#fusion-builder-layouts-sections .fusion-empty-library-message");b&&b.preventDefault(),!0!==FusionPageBuilderApp.layoutIsSaving&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==d?a.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:d,fusion_layout_content:c,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"sections"},complete:function(b){FusionPageBuilderApp.layoutIsSaving=!1,e.prepend(b.responseText),a(".fusion-save-element-fields").remove(),f.hide()}}):alert(fusionBuilderText.please_enter_element_name))},getContainerContent:function(b,c,d){var e="",f=this.$el.find(".fusion-builder-section-content");return e+=FusionPageBuilderApp.generateElementShortcode(this.$el,!0),f.find(".fusion_builder_row").each(function(){var b=a(this);e+="[fusion_builder_row]",b.find(".fusion-builder-column-outer").each(function(){var b=a(this),c=b.data("cid"),d=FusionPageBuilderViewManager.getView(c);e+=d.getColumnContent(b)}),e+="[/fusion_builder_row]"}),e+="[/fusion_builder_container]"},saveElementDialog:function(b){var c;c=void 0!==this.model.get("admin_label")&&""!==this.model.get("admin_label")?this.model.get("admin_label"):"",b&&b.preventDefault(),FusionPageBuilderApp.showLibrary(),a("#fusion-builder-layouts-sections-trigger").click(),a("#fusion-builder-layouts-sections .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="'+c+'" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_section+"</a></div>")},showSettings:function(b){var c,d={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};b&&b.preventDefault(),c=new FusionPageBuilder.ModalView(d),a("body").append(c.render().el),this.hideHundredPercentOption()},hideHundredPercentOption:function(){var a=jQuery("#page_template"),b=jQuery("#pyre_portfolio_width_100").val(),c=jQuery('.fusion_builder_container li[data-option-id="hundred_percent"]');"100-width.php"!==a.val()&&"yes"!==b&&(void 0===b||"no"===b||"default"===b&&""===FusionPageBuilderApp.fullWidth)&&c.hide()},addContainer:function(a){var b,c,d,e;a&&(a.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",b=FusionPageBuilderViewManager.generateCid(),c=fusionAllElements.fusion_builder_container.params,d={},_.each(c,function(a){e=_.isObject(a.value)?a.default:a.value,d[a.param_name]=e,"dimension"===a.type&&_.isObject(a.value)&&_.each(a.value,function(a,b){d[b]=a})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:b,params:d,view:this,created:"auto"}]),FusionPageBuilderApp.activeModal=""},addRow:function(){var a=FusionPageBuilderViewManager.generateCid();this.collection.add([{type:"fusion_builder_row",element_type:"fusion_builder_row",added:"manually",cid:a,parent:this.model.get("cid"),view:this}])},cloneContainer:function(b){var c,d;b&&b.preventDefault(),c=a.extend(!0,{},this.model.attributes),c.cid=FusionPageBuilderViewManager.generateCid(),c.created="manually",c.view=this,FusionPageBuilderApp.collection.add(c),d=this.$el,d.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var b=a(this),d=b.data("cid"),e=FusionPageBuilderElements.find(function(a){return a.get("cid")==d}),f=a.extend(!0,{},e.attributes);f.created="manually",f.cid=FusionPageBuilderViewManager.generateCid(),f.parent=c.cid,FusionPageBuilderApp.collection.add(f),b.find(".fusion-builder-column-outer").each(function(){var b=a(this),c=b.data("cid"),d=FusionPageBuilderElements.find(function(a){return a.get("cid")==c}),e=a.extend(!0,{},d.attributes);e.created="manually",e.cid=FusionPageBuilderViewManager.generateCid(),e.parent=f.cid,e.from="fusion_builder_container",e.cloned=!0,FusionPageBuilderApp.collection.add(e),b.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var b,c,d,f,g,h,i;a(this).hasClass("fusion_module_block")?(b=a(this),c=b.data("cid"),d=FusionPageBuilderElements.find(function(a){return a.get("cid")==c}),f=a.extend(!0,{},d.attributes),f.created="manually",f.cid=FusionPageBuilderViewManager.generateCid(),f.parent=e.cid,f.from="fusion_builder_container",FusionPageBuilderApp.collection.add(f)):a(this).hasClass("fusion_builder_row_inner")&&(g=a(this),h=g.data("cid"),void 0!==(i=FusionPageBuilderViewManager.getView(h))&&i.cloneNestedRow("",e.cid))})})}),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.cloned_section,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeContainer:function(a){var b;if(a&&a.preventDefault(),b=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(b,function(a){"fusion_builder_row"===a.model.get("type")&&a.removeRow()}),FusionPageBuilderViewManager.countElementsByType("fusion_builder_container")>1||(FusionPageBuilderApp.blankPage=!0),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),!0===FusionPageBuilderApp.blankPage)return void FusionPageBuilderApp.clearBuilderLayout(!0);a&&(fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.deleted_section,FusionPageBuilderEvents.trigger("fusion-element-removed"))},toggleContainer:function(b){var c=a(b.currentTarget);b&&b.preventDefault(),this.$el.toggleClass("fusion-builder-section-folded"),c.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down"),this.$el.hasClass("fusion-builder-section-folded")?this.model.attributes.params.admin_toggled="yes":this.model.attributes.params.admin_toggled="no",FusionPageBuilderEvents.trigger("fusion-element-edited")},renameContainer:function(a){var b,c;if(13==(a.keyCode||a.which))return a.preventDefault(),this.$el.find(".fusion-builder-section-name").blur(),!1;b=this.model,c=this.$el.find(".fusion-builder-section-name"),clearTimeout(this.typingTimer),this.typingTimer=setTimeout(function(){b.attributes.params.admin_label=c.val(),FusionPageBuilderEvents.trigger("fusion-element-edited")},this.doneTypingInterval)}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.BlankPageView=window.wp.Backbone.View.extend({className:"fusion_builder_blank_page",template:FusionPageBuilder.template(a("#fusion-builder-blank-page-template").html()),events:{"click .fusion-builder-new-section-add":"addContainer","click .fusion-builder-video-button":"openVideoModal"},initialize:function(){},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el.find("#video-dialog").dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,height:420,width:590}),this},openVideoModal:function(a){a.preventDefault(),jQuery("#video-dialog").dialog("open")},addContainer:function(a){var b,c,d,e;a&&(a.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",b=FusionPageBuilderViewManager.generateCid(),c=fusionAllElements.fusion_builder_container.params,d={},_.each(c,function(a){e=_.isObject(a.value)?a.default:a.value,d[a.param_name]=e,"dimension"===a.type&&_.isObject(a.value)&&_.each(a.value,function(a,b){d[b]=a})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:b,params:d,view:this,created:"auto"}]),this.remove()},removeBlankPageHelper:function(a){a&&a.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove()}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.RowView=window.wp.Backbone.View.extend({className:"fusion_builder_row",template:FusionPageBuilder.template(a("#fusion-builder-row-template").html()),events:{"click .fusion-builder-insert-column":"displayColumnsOptions"},initialize:function(){},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),"manually"!==this.model.get("created")&&this.$el.find(".fusion-builder-insert-column").trigger("click"),this},sortableColumns:function(){var b=this,c=b.$el.find(".fusion-builder-row-container");this.model.get("cid");c.sortable({helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",items:".fusion-builder-column-outer",connectWith:".fusion-builder-row-container",tolerance:"pointer",update:function(c,d){var e=d.item.data("cid"),f=b.collection.find(function(a){return a.get("cid")==e});f.get("parent")===b.model.attributes.cid&&a(d.item).closest(c.target).length||f.set("parent",b.model.attributes.cid),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},displayColumnsOptions:function(b){var c;b&&b.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),c=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"column_library"},view:this}),a("body").append(c.render().el)},removeRow:function(a,b){var c;a&&a.preventDefault(),c=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(c,function(a){a.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),a&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.InnerRowView=window.wp.Backbone.View.extend({className:"fusion_builder_row_inner fusion_builder_column_element",template:FusionPageBuilder.template(a("#fusion-builder-row-inner-template").html()),events:{"click .fusion-builder-remove-inner-row":"removeRow","click .fusion-builder-save-inner-row-dialog-button":"saveElementDialog","click .fusion-builder-clone-inner-row":"cloneNestedRow","click .fusion-builder-inner-row-overlay":"showInnerRowDialog","click .fusion-builder-inner-row-close":"hideInnerRowDialog","click .fusion-builder-inner-row-close-icon":"hideInnerRowDialog"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.listenTo(FusionPageBuilderEvents,"fusion-close-inner-modal",this.hideInnerRowDialog)},showInnerRowDialog:function(b){var c=this.$el;b&&b.preventDefault(),c.find(".fusion-builder-row-content").show(),a("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>')},hideInnerRowDialog:function(b){var c=this.$el,d="";b&&b.preventDefault(),c.find(".fusion-builder-row-content").hide(),a("body").removeClass("fusion_builder_inner_row_no_scroll"),a(".fusion_builder_modal_inner_row_overlay").remove(),this.$el.find(".fusion-builder-column-inner").each(function(){d+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(d.slice(0,d.length-3))},render:function(){var a=this.$el,b="";return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),setTimeout(function(){a.find(".fusion-builder-column-inner").each(function(){b+=jQuery(this).data("column-size").replace("_","/")+" + "}),a.find("> h4").after("<p>"+b.slice(0,b.length-3)+"</p>")},100),this},cloneNestedRow:function(b,c){var d,e;b&&b.preventDefault(),d=a.extend(!0,{},this.model.attributes),d.created="manually",d.cid=FusionPageBuilderViewManager.generateCid(),b&&(d.appendAfter=this.$el),c&&(d.parent=c),FusionPageBuilderApp.collection.add(d),e=this.$el,e.find(".fusion-builder-column-inner").each(function(){var b=a(this),c=b.data("cid"),e=FusionPageBuilderElements.findWhere({cid:c}),f=a.extend(!0,{},e.attributes);f.created="manually",f.cid=FusionPageBuilderViewManager.generateCid(),f.parent=d.cid,FusionPageBuilderApp.collection.add(f),b.find(".fusion_module_block").each(function(){var b=a(this),c=void 0===b.data("cid")?b.find(".fusion-builder-data-cid").data("cid"):b.data("cid"),d=FusionPageBuilderElements.find(function(a){return a.get("cid")==c}),e=a.extend(!0,{},d.attributes);e.created="manually",e.cid=FusionPageBuilderViewManager.generateCid(),e.parent=f.cid,e.from="fusion_builder_row_inner",FusionPageBuilderApp.collection.add(e)})}),c||(fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.cloned_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},saveElementDialog:function(b){b&&b.preventDefault(),FusionPageBuilderApp.showLibrary(),a("#fusion-builder-layouts-elements-trigger").click(),a("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div>")},saveElement:function(b){var c=(this.$el,this.getInnerRowContent()),d=a("#fusion-builder-save-element-input").val(),e=a("#fusion-builder-layouts-elements .fusion-page-layouts"),f=a("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message");b&&b.preventDefault(),""!==d?a.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:d,fusion_layout_content:c,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements",fusion_layout_element_type:"nested"},complete:function(b){e.prepend(b.responseText),a(".fusion-save-element-fields").remove(),f.hide()}}):alert(fusionBuilderText.please_enter_element_name)},getInnerRowContent:function(){var b="",c=this.$el,d=c.data("cid");FusionPageBuilderElements.findWhere({cid:d});return b+="[fusion_builder_row_inner]",c.find(".fusion-builder-column-inner").each(function(){var c,d=a(this),e=d.data("cid"),f=FusionPageBuilderElements.findWhere({cid:e}),g={};_.each(f.get("params"),function(a,b){g[b]="undefined"===a?"":a}),c={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(c,function(a,b){void 0===g[b]&&(g[b]=a)}),
b+='[fusion_builder_column_inner type="'+f.get("layout")+'" background_position="'+g.background_position+'" background_color="'+g.background_color+'" border_size="'+g.border_size+'" border_color="'+g.border_color+'" border_style="'+g.border_style+'" spacing="'+g.spacing+'" background_image="'+g.background_image+'" background_repeat="'+g.background_repeat+'" padding="'+g.padding+'" margin_top="'+g.margin_top+'" margin_bottom="'+g.margin_bottom+'" class="'+g.class+'" id="'+g.id+'" animation_type="'+g.animation_type+'" animation_speed="'+g.animation_speed+'" animation_direction="'+g.animation_direction+'" hide_on_mobile="'+g.hide_on_mobile+'" center_content="'+g.center_content+'" last="'+g.last+'" min_height="'+g.min_height+'" hover_type="'+g.hover_type+'" link="'+g.link+'"]',d.find(".fusion_module_block").each(function(){b+=FusionPageBuilderApp.generateElementShortcode(a(this),!1)}),b+="[/fusion_builder_column_inner]"}),b+="[/fusion_builder_row_inner]"},sortableColumns:function(){var b=this,c=b.$el.find(".fusion-builder-row-container-inner");this.model.get("cid");c.sortable({items:".fusion-builder-column-inner",helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog",tolerance:"pointer",update:function(c,d){var e=d.item.data("cid"),f=b.collection.find(function(a){return a.get("cid")==e});f.get("parent")===b.model.attributes.cid&&a(d.item).closest(c.target).length||f.set("parent",b.model.attributes.cid),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved_nested_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},removeRow:function(a,b){var c;a&&a.preventDefault(),c=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(c,function(a){a.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),a&&(fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.deleted_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-removed"))}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.NestedColumnView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(a("#fusion-builder-inner-column-template").html()),events:{"click .fusion-builder-add-element":"addModule","click .fusion-builder-settings-column":"showSettings"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.$el.attr("data-column-size",this.model.get("layout"))},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableElements(),this},sortableElements:function(b){var c=this;this.$el.sortable({items:".fusion_module_block",connectWith:".fusion-builder-column-inner",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-add-element, .fusion-builder-insert-column, .fusion-builder-save-module-dialog",tolerance:"pointer",update:function(b,d){var e=a(d.item),f=d.item.data("cid"),g=c.collection.find(function(a){return a.get("cid")==f});a(d.item).closest(b.target).length&&1===a(b.target).find(".fusion_module_block").length&&e.insertBefore(a(b.target).find(".fusion-builder-add-element")),g.get("parent")===c.model.attributes.cid&&a(d.item).closest(b.target).length||g.set("parent",c.model.attributes.cid),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved+" "+fusionAllElements[g.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},showSettings:function(b){var c,d={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};b&&b.preventDefault(),c=new FusionPageBuilder.ModalView(d),a("body").append(c.render().el)},removeColumn:function(a){var b;a&&a.preventDefault(),b=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(b,function(a){a.removeElement()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),a&&FusionPageBuilderEvents.trigger("fusion-element-removed")},addModule:function(b){var c,d,e;b&&(b.preventDefault(),b.stopPropagation()),FusionPageBuilderApp.innerColumn="true",FusionPageBuilderApp.parentColumnId=this.model.get("cid"),d=a(b.target),e=d.is("span")?d.parent(".fusion-builder-add-element"):d,e.parent().is(b.delegateTarget)&&(c=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_library"},view:this}),a("body").append(c.render().el))}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.ColumnView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(a("#fusion-builder-column-template").html()),events:{"click .fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)":"addModule","click .fusion-builder-settings-column:not(.fusion-builder-column-inner .fusion-builder-settings-column)":"showSettings","click .fusion-builder-resize-column:not(.fusion-builder-column-inner .fusion-builder-resize-column)":"columnSizeDialog","click .column-size:not(.fusion-builder-column-inner .column-size)":"columnSize","click .fusion-builder-clone-column:not(.fusion-builder-column-inner .fusion-builder-clone-column)":"cloneColumn","click .fusion-builder-remove-column:not(.fusion-builder-column-inner .fusion-builder-remove-column)":"removeColumn","click .fusion-builder-save-column-dialog:not(.fusion-builder-column-inner .fusion-builder-save-column-dialog)":"saveColumnDialog"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.$el.attr("data-column-size",this.model.get("layout"))},render:function(){var a,b;return this.$el.html(this.template(this.model.toJSON())),this.sortableElements(),a=this.model.get("layout"),this.$el.find(".column-size-"+a).addClass("active-size"),b=a.replace("_","/"),this.$el.find(".fusion-builder-resize-column").text(b),this},sortableElements:function(b){var c=this;this.$el.sortable({items:".fusion_module_block:not(.fusion_builder_row_inner .fusion_module_block), .fusion_builder_row_inner",connectWith:".fusion-builder-column-outer",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-add-element, .fusion-builder-insert-column, .fusion-builder-save-module-dialog, .fusion-builder-remove-inner-row, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",tolerance:"pointer",over:function(b,c){1===a(b.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&a(b.target).find(".ui-sortable-placeholder").insertBefore(a(b.target).find(".fusion-builder-add-element"))},update:function(b,d){var e=a(d.item),f=d.item.data("cid"),g=c.collection.find(function(a){return a.get("cid")==f});a(d.item).closest(b.target).length&&1===a(b.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&e.insertBefore(a(b.target).find("> .fusion-builder-add-element")),g.get("parent")===c.model.attributes.cid&&a(d.item).closest(b.target).length||g.set("parent",c.model.attributes.cid),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved+" "+fusionAllElements[g.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},saveColumnDialog:function(b){b&&b.preventDefault(),FusionPageBuilderApp.showLibrary(),a("#fusion-builder-layouts-columns-trigger").click(),a("#fusion-builder-layouts-columns .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_column+"</a></div>")},saveElement:function(b){var c=this.$el,d=this.getColumnContent(c),e=a("#fusion-builder-save-element-input").val(),f=a("#fusion-builder-layouts-columns .fusion-page-layouts"),g=a("#fusion-builder-layouts-columns .fusion-page-layouts .fusion-empty-library-message");b&&b.preventDefault(),!0!==FusionPageBuilderApp.layoutIsSaving&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==e?a.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:e,fusion_layout_content:d,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"columns"},complete:function(b){FusionPageBuilderApp.layoutIsSaving=!1,f.prepend(b.responseText),a(".fusion-save-element-fields").remove(),g.hide()}}):alert(fusionBuilderText.please_enter_element_name))},getColumnContent:function(b){var c,d="",e=b.data("cid"),f=FusionPageBuilderElements.findWhere({cid:e}),g={};return _.each(f.get("params"),function(a,b){g[b]="undefined"===a?"":a}),c={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(c,function(a,b){void 0===g[b]&&(g[b]=a)}),d+='[fusion_builder_column type="'+f.get("layout")+'"',_.each(g,function(a,b){d+=" "+b+'="'+a+'"'}),d+="]",b.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var b;a(this).hasClass("fusion_module_block")?d+=FusionPageBuilderApp.generateElementShortcode(a(this),!1):(b=a(this),d+="[fusion_builder_row_inner]",b.find(".fusion-builder-column-inner").each(function(){var b,c=a(this),e=c.data("cid"),f=FusionPageBuilderElements.findWhere({cid:e}),g={};_.each(f.get("params"),function(a,b){g[b]="undefined"===a?"":a}),b={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(b,function(a,b){void 0===g[b]&&(g[b]=a)}),d+='[fusion_builder_column_inner type="'+f.get("layout")+'"',_.each(g,function(a,b){d+=" "+b+'="'+a+'"'}),d+="]",c.find(".fusion_module_block").each(function(){d+=FusionPageBuilderApp.generateElementShortcode(a(this),!1)}),d+="[/fusion_builder_column_inner]"}),d+="[/fusion_builder_row_inner]")}),d+="[/fusion_builder_column]"},showSettings:function(b){var c,d={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};b&&b.preventDefault(),c=new FusionPageBuilder.ModalView(d),a("body").append(c.render().el)},removeColumn:function(a){var b;a&&a.preventDefault(),b=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(b,function(a){"fusion_builder_row"===a.model.get("type")||"fusion_builder_row_inner"===a.model.get("type")?a.removeRow():a.removeElement()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),a&&(fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.deleted+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-removed"))},addModule:function(b){var c,d,e;b&&(b.preventDefault(),b.stopPropagation()),FusionPageBuilderApp.innerColumn="false",FusionPageBuilderApp.parentColumnId=this.model.get("cid"),d=a(b.target),e=d.is("span")?d.parent(".fusion-builder-add-element"):d,e.parent().is(b.delegateTarget)&&(c=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_library"},view:this}),a("body").append(c.render().el))},cloneColumn:function(b){var c,d=a.extend(!0,{},this.model.attributes);b&&b.preventDefault(),d.created="manually",d.cid=FusionPageBuilderViewManager.generateCid(),d.targetElement=this.$el,d.cloned=!0,FusionPageBuilderApp.collection.add(d),c=this.$el,c.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var b,c,e,f,g,h,i;a(this).hasClass("fusion_module_block")?(b=a(this),c=void 0===b.data("cid")?b.find(".fusion-builder-data-cid").data("cid"):b.data("cid"),e=FusionPageBuilderElements.find(function(a){return a.get("cid")==c}),f=a.extend(!0,{},e.attributes),f.created="manually",f.cid=FusionPageBuilderViewManager.generateCid(),f.parent=d.cid,f.from="fusion_builder_column",FusionPageBuilderApp.collection.add(f)):a(this).hasClass("fusion_builder_row_inner")&&(g=a(this),h=void 0===g.data("cid")?g.find(".fusion-builder-data-cid").data("cid"):g.data("cid"),void 0!==(i=FusionPageBuilderViewManager.getView(h))&&i.cloneNestedRow("",d.cid))}),b&&(fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.cloned+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},columnSizeDialog:function(a){a&&a.preventDefault(),this.$el.find(".column-sizes").toggle()},columnSize:function(b){var c=a(b.currentTarget),d=this.model.get("layout"),e=c.attr("data-column-size"),f="";b&&b.preventDefault(),void 0!==e&&(this.model.set("layout",e),this.$el.removeClass("fusion-builder-column-"+d),this.$el.addClass("fusion-builder-column-"+e),f=e.replace("_","/"),this.$el.find(".fusion-builder-resize-column").text(f),this.$el.find(".column-sizes").hide(),this.$el.find(".column-sizes .column-size").removeClass("active-size"),this.$el.find(".column-size-"+e).addClass("active-size"),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.resized_column+" "+f,FusionPageBuilderEvents.trigger("fusion-element-edited"))}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.ModalView=window.wp.Backbone.View.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(a("#fusion-builder-modal-template").html()),events:{"click .fusion-builder-modal-save":"saveSettings","click .fusion-builder-modal-close":"closeModal"},initialize:function(a){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-remove-modal-view",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-close-modal",this.closeModal),this.options=a,this.elementType=""},render:function(){var b,c,d,e={model:this.model,collection:this.collection,view:this.options.view};return void 0===this.model||void 0===this.model.get("view")||"row_inner"!==this.model.get("element_type")&&"fusion_builder_row"!==this.model.get("element_type")||this.model.get("parent")===this.model.get("view").$el.data("cid")||this.model.set("view",FusionPageBuilderViewManager.getView(this.model.get("parent")),{silent:!0}),void 0!==this.model?this.$el.html(this.template(this.model.toJSON())):this.$el.html(this.template()),d=this.$el.find(".fusion-builder-modal-container"),"column_library"===this.attributes["data-modal_view"]?b=new FusionPageBuilder.ColumnLibraryView(e):"element_library"===this.attributes["data-modal_view"]?(e.attributes={"data-parent_cid":this.model.get("cid")},b=new FusionPageBuilder.ElementLibraryView(e)):"all_elements_generator"===this.attributes["data-modal_view"]?(e.attributes={},b=new FusionPageBuilder.GeneratorElementsView(e)):"multi_element_child_settings"===this.attributes["data-modal_view"]?(e.attributes={},b=new FusionPageBuilder.MultiElementSettingsView(e)):"element_settings"===this.attributes["data-modal_view"]&&(e.attributes={"data-element_type":this.model.get("element_type")},void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&(this.elementType="multi"),e.view=this,c=fusionAllElements[this.model.get("element_type")].custom_settings_view_name,b=void 0!==c&&""!==c?new FusionPageBuilder[c](e):new FusionPageBuilder.ElementSettingsView(e)),d.append(b.render().el),a(".fusion_builder_modal_overlay").length<1&&a(".fusion_builder_modal_inner_row_overlay").length<1&&a("body").addClass("fusion_builder_no_scroll").append('<div class="fusion_builder_modal_overlay"></div>'),"column_library"!==this.attributes["data-modal_view"]&&"element_library"!==this.attributes["data-modal_view"]&&"all_elements_generator"!==this.attributes["data-modal_view"]||this.elementSearchFilter(),"multi"===this.elementType&&this.$el.addClass("fusion_builder_modal_multi_element_settings_container"),this},closeModal:function(b){var c,d,e,f,g,h,i,j,k;b&&b.preventDefault(),FusionPageBuilderApp.activeModal="",this.$el.find(".wp-color-picker").each(function(){a(this).wpColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),1==FusionPageBuilderApp.newContainerAdded&&(FusionPageBuilderApp.newContainerAdded=!1),this.$el.find(".tinymce").each(function(){i=a(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(i)}),void 0!==this.model&&!0!==FusionPageBuilderApp.MultiElementChildSettings&&"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,!0===FusionPageBuilderApp.shortcodeGenerator?void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",j=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"),k=FusionPageBuilderViewManager.getView(j),k.removeView(),j="",k=""):void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_child"===this.model.get("multi")?FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="":(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""):"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")&&("fusion_builder_row"===this.model.get("element_type")?(c=this.model.get("parent"),d=FusionPageBuilderViewManager.getView(c),void 0!==d&&d.removeContainer()):(f=fusionAllElements[this.model.get("element_type")].params,e={},_.each(f,function(a){g=_.isObject(a.value)?a.default:a.value,e[a.param_name]=g}),h={params:e},this.model.set(h),b&&FusionPageBuilderEvents.trigger("fusion-element-added")),"element"===this.model.get("type")&&this.deleteModel(),void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view")),this.removeOverlay(),this.remove()},removeView:function(){this.removeOverlay(),void 0!==this.model&&"fusion_builder_row"!==this.model.get("type")&&"fusion_builder_column"!==this.model.get("type")&&"fusion_builder_row_inner"!==this.model.get("type")&&"fusion_builder_column_inner"!==this.model.get("type")||this.remove()},saveSettings:function(b){var c,d,e,f,g,h;b&&b.preventDefault(),this.$el.find(".wp-color-picker").each(function(){a(this).wpColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0!==FusionPageBuilderApp.MultiElementChildSettings?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,c={params:{}},"fusion_builder_container"===this.model.get("element_type")&&(c.params.admin_label=void 0!==this.model.attributes.params.admin_label?this.model.attributes.params.admin_label:""),this.$el.find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var b,d,e=a(this);d=e.is("#generator_element_content")||e.is("#fusion_builder_content_main")||e.is("#element_content")||e.is("#generator_multi_child_content")?"element_content":e.attr("id"),e.is("#fusion_builder_content_main")?b=e.val():e.is(":checkbox")||(b=e.is("#generator_element_content")?fusionBuilderGetContent("generator_element_content"):e.is("#generator_multi_child_content")?fusionBuilderGetContent("generator_multi_child_content"):e.is("textarea#element_content")&&e.parents(".fusion-builder-option").hasClass("tinymce")?fusionBuilderGetContent("element_content"):e.val()),e.is("input")&&""!==b&&(b=e.hasClass("fusion-builder-upload-field")||e.is("#generator_element_content")||e.is("#generator_multi_child_content")?b:_.escape(b)),"infobox_content"==d&&(b=_.escape(b)),c.params[d]=b}),void 0!==fusionAllElements[this.model.get("element_type")].escape_html&&!0===fusionAllElements[this.model.get("element_type")].escape_html&&(c.params.element_content=_.escape(c.params.element_content)),void 0!==fusionAllElements[this.model.get("element_type")].on_save&&(f=fusionAllElements[this.model.get("element_type")].on_save,"function"==typeof FusionPageBuilderApp[f]&&(c=FusionPageBuilderApp[f](c,this))),"fusion_code"===this.model.get("element_type")&&1===Number(FusionPageBuilderApp.disable_encoding)&&(c.params.element_content=FusionPageBuilderApp.base64Encode(c.params.element_content)),!0===FusionPageBuilderApp.shortcodeGenerator?"multi_element_parent"===this.model.get("multi")?(this.model.set(c,{silent:!0}),d=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(d),FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",h=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"),g=FusionPageBuilderViewManager.getView(h),g.removeView(),h="",g="",this.remove(),this.removeOverlay()):"multi_element_child"===this.model.get("multi")?(this.model.set(c),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",this.remove()):("fusion_builder_column"===this.model.get("element_type")&&(c.params.type=this.model.get("layout")),"fusion_builder_container"===this.model.get("element_type")&&(c.params.element_content="[fusion_builder_row][/fusion_builder_row]"),this.model.set(c,{silent:!0}),d=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(d,FusionPageBuilderApp.shortcodeGeneratorEditorID),"video"!==FusionPageBuilderApp.shortcodeGeneratorEditorID&&(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""),this.remove(),!1!==FusionPageBuilderApp.builderActive&&!0!==FusionPageBuilderApp.fromExcerpt||(this.removeOverlay(),FusionPageBuilderApp.fromExcerpt=!1)):("multi_element_child"===this.model.get("multi")?(this.model.set(c,{silent:!0}),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),this.remove()):"multi_element_parent"===this.model.get("multi")?(void 0===this.model.get("added")&&(fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(c),this.$el.find(".tinymce").each(function(){e=a(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(e)}),FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view"),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),this.generatePreview(),this.removeOverlay()):(void 0===this.model.get("added")&&(fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(c),this.$el.find(".tinymce").each(function(){e=a(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(e)}),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),!0===FusionPageBuilderApp.builderActive&&this.generatePreview(),this.removeOverlay()),b&&FusionPageBuilderEvents.trigger("fusion-element-added")),FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGenerator=FusionPageBuilderApp.manualGenerator,FusionPageBuilderApp.shortcodeGeneratorEditorID=FusionPageBuilderApp.manualEditor,FusionPageBuilderApp.manuallyAdded=!1),this.$el.find(".tinymce").each(function(){e=a(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(e)}),FusionPageBuilderApp.activeModal=""},removeOverlay:function(){a(".fusion_builder_modal_overlay").length&&a(".fusion-builder-modal-settings-container").length<2&&(a(".fusion_builder_modal_overlay").remove(),a("body").removeClass("fusion_builder_no_scroll"))},generatePreview:function(){var a,b,c,d,e,f=this.model.get("element_type");"fusion_builder_container"===f&&(d=this.model.get("params"),b=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el,e=fusionBuilderText.empty_section,""!==d.background_image&&(e=fusionBuilderText.empty_section_with_bg),b.find(".fusion-builder-empty-section").html(e)),void 0!==fusionAllElements[f].preview&&(a={model:this.model,collection:FusionPageBuilderElements},b=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-module-preview"),c=new FusionPageBuilder.ElementPreviewView(a),b.html("").append(c.render().el))},deleteModel:function(){FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-remove").click()},elementSearchFilter:function(){var b,c,d=this.$el;d.find(".fusion-elements-filter").on("change paste keyup",function(){a(this).val()?(c=a(this).val().toLowerCase(),d.find(".fusion-builder-all-modules li").each(function(){b=a(this).find(".fusion_module_title").text().trim().toLowerCase(),"portfolio"===b&&(b+=" recent works"),-1!==b.search(c)?a(this).show():a(this).hide()})):d.find(".fusion-builder-all-modules li").show()})}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.NextPage=window.wp.Backbone.View.extend({className:"fusion-builder-next-page",template:FusionPageBuilder.template(a("#fusion-builder-next-page-template").html()),events:{"click .fusion-builder-delete-next-page":"removeContainer"},initialize:function(){},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},removeContainer:function(a){a&&a.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),a&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.ElementSettingsView=window.wp.Backbone.View.extend({className:"fusion_builder_module_settings",template:FusionPageBuilder.template(a("#fusion-builder-block-module-settings-template").html()),events:{"click #qt_element_content_fusion_shortcodes_text_mode":"activateSCgenerator"},activateSCgenerator:function(b){openShortcodeGenerator(a(b.target))},initialize:function(){var a,b,c;this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeElement),void 0!==fusionAllElements[this.model.get("element_type")].on_settings&&(a=fusionAllElements[this.model.get("element_type")].on_settings,"function"==typeof FusionPageBuilderApp[a]&&(b=this.model.get("params"),c=FusionPageBuilderApp[a](b,this),this.model.set("params",c)))},render:function(){function b(a,b,c,d,e,f,g,h,i,j,k,l){var m=noUiSlider.create(u[a],{start:[g],step:f,direction:l,range:{min:d,max:e},format:wNumb({decimals:h})}),n=!1;i&&""===j.val()&&i.parent().addClass("checked"),i&&i.on("click",function(b){b.preventDefault(),u[a].noUiSlider.set(k),j.val(""),jQuery(this).parent().addClass("checked")}),m.on("update",function(a,c){i&&n&&(i.parent().removeClass("checked"),j.val(a[c])),n=!0,jQuery(this.target).closest(".fusion-slider-container").prev().val(a[c]).trigger("change"),J.find("#"+b).trigger("change")}),c.on("keyup",function(b,c){i&&(i.parent().removeClass("checked"),j.val(b[c])),this.value!==u[a].noUiSlider.get()&&u[a].noUiSlider.set(this.value)})}var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=this.$el,K="",L=!1,M=this,N=!1;return w=this.model,"undefined"!==w.attributes.params.settings_lvl&&"parent"===w.attributes.params.settings_lvl&&(N=!0,G=w.attributes.params),void 0!==w.get&&void 0!==w.get("allow_generator")&&!0===w.get("allow_generator")&&(FusionPageBuilderApp.allowShortcodeGenerator=!0),this.$el.html(this.template({atts:this.model.attributes})),D=this.$el.find("[data-placeholder]"),d=this.$el.find(".fusion-editor-field"),f=this.$el.find(".fusion-builder-color-picker-hex"),g=this.$el.find(".fusion-builder-upload-button"),h=this.$el.find(".fusion-iconpicker"),i=this.$el.find(".fusion-form-multiple-select"),j=this.$el.find(".fusion-form-checkbox-button-set"),k=this.$el.find(".fusion-form-radio-button-set"),u=this.$el.find(".fusion-slider-container"),x=this.$el.find(".fusion-select-field"),z=this.$el.find(".single-builder-dimension"),B=this.$el.find(".fusion-builder-code-block"),H=this.$el.find(".fusion-builder-link-button"),I=this.$el.find(".fusion-datetime"),D.length&&D.on("focus",function(a){jQuery(a.target).data("placeholder")===jQuery(a.target).val()&&jQuery(a.target).val("")}),H.length&&FusionPageBuilderApp.fusionBuilderActivateLinkSelector(H),I.length&&jQuery(I).datetimepicker({format:"yyyy-MM-dd hh:mm:ss"}),f.length&&f.each(function(){var b=a(this),c=b.parents(".fusion-builder-option").find(".fusion-builder-default-reset");a(this).data("default")&&a(this).data("default").length?(a(this).wpColorPicker({change:function(a,d){M.colorChange(d.color.toString(),b,c)},clear:function(a,c){M.colorClear(a,b)}}),c.on("click","a",function(a){a.preventDefault(),M.colorClear(a,b)})):a(this).wpColorPicker({}),!0!==a(this).data("alpha")&&a(this).wpColorPicker().change()}),B.length&&B.each(function(){A=a(this).attr("id"),C=J.find("#"+A),FusionPageBuilderApp.codeEditor=CodeMirror.fromTextArea(C[0],{lineNumbers:!0,lineWrapping:!0,autofocus:!0}),setTimeout(function(){FusionPageBuilderApp.codeEditor.refresh(),FusionPageBuilderApp.codeEditor.focus()},100)}),z.length&&z.each(function(){jQuery(this).find(".fusion-builder-dimension input").on("change paste keyup",function(a){jQuery(this).parents(".single-builder-dimension").find('input[type="hidden"]').val((jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val():"0px"))})}),x.length&&x.chosen({width:"100%",disable_search_threshold:10}),g.length&&FusionPageBuilderApp.FusionBuilderActivateUpload(g),h.length&&(l=h.find(".fusion-iconpicker-input").val(),m=h.find(".fusion-iconpicker-input").attr("id"),n=h.find(".icon_select_container"),o=h.find(".fusion-icon-search"),FusionPageBuilderApp.fusion_builder_iconpicker(l,m,n,o)),i.length&&i.each(function(){E=fusionBuilderText.select_options_or_leave_blank_for_all,-1!==jQuery(this).attr("id").indexOf("cat_slug")?E=fusionBuilderText.select_categories_or_leave_blank_for_all:-1!==jQuery(this).attr("id").indexOf("exclude_cats")&&(E=fusionBuilderText.select_categories_or_leave_blank_for_none),
jQuery(this).chosen({width:"100%",placeholder_text_multiple:E})}),j.length&&(s=this.$el.find(".fusion-form-checkbox-button-set.hide_on_mobile"),s.length&&(t=s.find(".button-set-value").val(),"no"!=t&&""!=t||s.find("a").addClass("ui-state-active"),"yes"==t&&s.find('a:not([data-value="small-visibility"])').addClass("ui-state-active")),j.find("a").on("click",function(a){a.preventDefault(),q=jQuery(this).parents(".fusion-form-checkbox-button-set"),jQuery(this).toggleClass("ui-state-active"),q.find(".button-set-value").val(q.find(".ui-state-active").map(function(a,b){return jQuery(b).data("value")}).get())})),k.length&&k.find("a").on("click",function(a){a.preventDefault(),r=jQuery(this).parents(".fusion-form-radio-button-set"),r.find(".ui-state-active").removeClass("ui-state-active"),jQuery(this).addClass("ui-state-active"),r.find(".button-set-value").val(r.find(".ui-state-active").data("value")).trigger("change")}),u.length&&(v=0,Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0},u.each(function(){var a=jQuery(this).data("id"),c=jQuery(this).prev(".fusion-slider-input"),d=jQuery(this).data("min"),e=jQuery(this).data("max"),f=jQuery(this).data("step"),g=jQuery(this).data("direction"),h=c.val(),i=f.countDecimals(),j=!!jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").length&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default"),k=!!j&&jQuery(this).parent().find(".fusion-hidden-value"),l=!!j&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default");b(v,a,c,d,e,f,h,i,j,k,l,g),v++})),void 0!==this.model.get&&"fusion_woo_shortcodes"===this.model.get("element_type")&&!0===FusionPageBuilderApp.shortcodeGenerator&&this.$el.find("#element_content").attr("id","generator_element_content"),d.length&&(e=d.closest(".fusion-builder-option"),void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(p=FusionPageBuilderViewManager.generateCid(),this.view_cid=p,e.hide(),d.attr("id","fusion_builder_content_main"),c=new FusionPageBuilder.MultiElementSortablesView({model:this,el:this.$el.find(".fusion-builder-option-advanced-module-settings"),attributes:{cid:p}}),FusionPageBuilderViewManager.addView(p,c),e.before(c.render()),""!==d.html()&&c.generateMultiElementChildSortables(d.html(),this.$el.find(".fusion-builder-option-advanced-module-settings").data("element_type"),N,G)):(K=d.html(),!0===FusionPageBuilderApp.shortcodeGenerator?(!0===FusionPageBuilderApp.shortcodeGeneratorMultiElementChild?d.attr("id","generator_multi_child_content"):d.attr("id","generator_element_content"),y=d.attr("id"),setTimeout(function(){d.wp_editor(K,y),jQuery("#"+y).data("placeholder")&&window.tinyMCE.get(y).on("focus",function(a){F=window.tinyMCE.get(y).getContent(),(F=jQuery("<div/>").html(F).text())===jQuery("#"+y).data("placeholder")&&window.tinyMCE.get(y).setContent("")})},100)):(y=d.attr("id"),setTimeout(function(){void 0!==w.get("allow_generator")&&!0===w.get("allow_generator")&&(L=!0),d.wp_editor(K,y,L),jQuery("#"+y).data("placeholder")&&window.tinyMCE.get(y).on("focus",function(a){F=window.tinyMCE.get(y).getContent(),(F=jQuery("<div/>").html(F).text())===jQuery("#"+y).data("placeholder")&&window.tinyMCE.get(y).setContent("")})},100)))),this.$el.find(".uploadattachment .fusion-builder-upload-button").on("click",function(a){alert(fusionBuilderText.to_add_images)}),setTimeout(function(){J.find("select, input, textarea, radio").filter(":eq(0)").not("[data-placeholder]").focus()},1),FusionPageBuilderApp.rangeOptionPreview(this.$el),void 0!==this.model&&void 0!==this.model.get&&FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],this.$el),this},removeElement:function(){this.remove()},colorChange:function(a,b,c){var d=b.data("default");a===d?c.addClass("checked"):c.removeClass("checked"),""===a&&null!==d&&(b.val(d),b.change(),b.val(""))},colorClear:function(a,b){var c=b.data("default");null!==c&&(b.val(c),b.change(),b.val(""),b.parent().parent().find(".wp-color-result").css("background-color",c))}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.MultiElementSettingsView=FusionPageBuilder.ElementSettingsView.extend({events:{"click .insert-slider-video":"addSliderVideo"},addSliderVideo:function(b){var c,d,e,f;b&&b.preventDefault(),FusionPageBuilderApp.manualGenerator=FusionPageBuilderApp.shortcodeGenerator,FusionPageBuilderApp.manualEditor=FusionPageBuilderApp.shortcodeGeneratorEditorID,FusionPageBuilderApp.manuallyAdded=!0,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.shortcodeGeneratorEditorID="video",e=a(b.currentTarget).data("type"),c=fusionAllElements[e].params,d={},_.each(c,function(a){f=_.isObject(a.value)?a.default:a.value,d[a.param_name]=f}),this.collection.add([{type:"generated_element",added:"manually",element_type:e,params:d}])}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.MultiElementSortablesView=window.wp.Backbone.View.extend({initialize:function(){!0===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElement=!0),this.listenTo(FusionPageBuilderEvents,"fusion-multi-element-edited",this.generateContent),this.listenTo(FusionPageBuilderEvents,"fusion-multi-remove-sortables-view",this.removeView),this.element_type=this.$el.data("element_type"),this.child_views=[],this.$el.attr("data-cid",this.attributes.cid),this.$sortable_options=this.$el.find(".fusion-builder-sortable-options"),this.$sortable_options.sortable({axis:"y",cancel:".fusion-builder-multi-setting-remove, .fusion-builder-multi-setting-options, .fusion-builder-multi-setting-clone",helper:"clone",update:function(a,b){FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}}),this.$add_sortable_item=this.$el.find(".fusion-builder-add-multi-child").addClass("fusion-builder-add-sortable-initial")},events:{"click .fusion-builder-add-multi-child":"addChildElement"},render:function(){return this},addChildElement:function(a){var b,c,d,e={};a&&a.preventDefault(),b=fusionAllElements[this.element_type].params,d=void 0!==fusionAllElements[this.element_type].allow_generator?fusionAllElements[this.element_type].allow_generator:"",_.each(b,function(a){c=_.isObject(a.value)?a.default:a.value,e[a.param_name]=c}),this.model.collection.add([{type:"element",element_type:this.element_type,cid:FusionPageBuilderViewManager.generateCid(),view:this,created:"manually",multi:"multi_element_child",child_element:"true",parent:this.attributes.cid,params:e,allow_generator:d}]),this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},generateContent:function(){var b="";this.$sortable_options.find("li").each(function(){var c=a(this);b+=FusionPageBuilderApp.generateElementShortcode(c,!1)}),this.$el.parents().find("#fusion_builder_content_main").html(b),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial")},removeView:function(a){a&&a.preventDefault(),this.remove()},generateMultiElementChildSortables:function(a,b,c,d){var e=this,f=jQuery.map(fusionMultiElements,function(a,b){return a}).join("|"),g=window.wp.shortcode.regexp(f),h=FusionPageBuilderApp.regExpShortcode(f),i=a.match(g);""!==a&&this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),_.each(i,function(a){var f,g,i,j,k,l,m=a.match(h),n=m[2],o=""!==m[3]?window.wp.shortcode.attrs(m[3]):"",p=m[5],q="",r=(FusionPageBuilderViewManager.generateCid(),{params:{}}),s=void 0!==fusionAllElements[n].allow_generator?fusionAllElements[n].allow_generator:"";if(void 0!==o.named&&void 0!==o.named.title&&o.named.title.length?q=o.named.title:void 0!==o.named&&void 0!==o.named.title_front&&o.named.title_front.length?q=o.named.title_front:void 0!==o.named&&void 0!==o.named.image&&o.named.image.length?(q=o.named.image,-1!==q.indexOf("/")&&-1===q.indexOf("[")&&(q=q.split("/"),q=q.slice(-1)[0])):void 0!==o.named&&"image"==o.named.type&&void 0!==p&&p.length?(q=p,-1!==q.indexOf("/")&&-1===q.indexOf("[")&&(q=q.split("/"),q=q.slice(-1)[0])):void 0!==o.named&&void 0!==o.named.video&&o.named.video.length?q=o.named.video:void 0!==o.named&&void 0!==p&&p.length&&(q=p),q=jQuery("<div/>").html(q).text(),q=jQuery("<div/>").html(q).text(),q=q&&q.length>15?q.substring(0,15)+"...":q,f={type:"element",element_type:b,element_name:q,cid:FusionPageBuilderViewManager.generateCid(),view:e,created:"auto",multi:"multi_element_child",child_element:"true",allow_generator:s,params:{},parent:e.attributes.cid},_.isObject(o.named)){for(g in o.named)i=g,("fusion_builder_column"===n&&"type"===i||"fusion_builder_column_inner"===n&&"type"===i)&&(i="layout",r[i]=o.named[g]),r.params[i]=o.named[g];f=_.extend(f,r)}f.params.element_content=p,void 0!==fusionAllElements[n].option_dependency&&(j=fusionAllElements[n].option_dependency,k=r.params[j],l=r.params.element_content,r.params[k]=l),!0===c&&"fusion_content_box"===b&&(f.params.iconcolor="",f.params.backgroundcolor="",f.params.circlecolor="",f.params.circlebordercolor="",f.params.circlebordersize="",f.params.outercirclebordercolor="",f.params.outercirclebordersize="",f.params.animation_type=d.animation_type,f.params.animation_direction=d.animation_direction,f.params.animation_speed=d.animation_speed,f.params.link_target=d.link_target),e.model.collection.add([f])})}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.MultiElementSortableChild=window.wp.Backbone.View.extend({tagName:"li",className:"fusion-builder-data-cid",initialize:function(){this.template=FusionPageBuilder.template(a("#fusion-builder-multi-child-sortable").html()),this.listenTo(FusionPageBuilderEvents,"fusion-multi-child-update-preview",this.updatePreview)},events:{"click .fusion-builder-multi-setting-options":"showSettings","click .fusion-builder-multi-setting-remove":"removeView","click .fusion-builder-multi-setting-clone":"cloneElement"},render:function(){return this.$el.html(this.template({atts:this.model.attributes})),this},cloneElement:function(b){var c,d=this.$el.find(".multi-element-child-name").html();b&&b.preventDefault(),c=a.extend(!0,{},this.model.attributes),c.created="manually",c.cid=FusionPageBuilderViewManager.generateCid(),c.cloned=!0,c.targetElement=this.$el,c.titleLabel=d,FusionPageBuilderApp.collection.add(c),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},showSettings:function(b){var c,d,e,f={};b&&b.preventDefault(),FusionPageBuilderApp.MultiElementChildSettings=!0,!0===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElementChild=!0),e=jQuery(document).find(".fusion-builder-option.range .fusion-hidden-value, .wp-color-picker, .has-child-dependency input, .has-child-dependency select, .has-child-dependency textarea, .has-child-dependency #fusion_builder_content_main, .has-child-dependency #fusion_builder_content_main_child").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts"),e.each(function(){jQuery(this).val().length&&(f[jQuery(this).attr("id")]=jQuery(this).val())}),this.model.set({parent_values:f}),d={model:this.model,collection:this.collection,attributes:{"data-modal_view":"multi_element_child_settings"}},c=new FusionPageBuilder.ModalView(d),a(".fusion_builder_modal_multi_element_settings_container").last().after(c.render().el)},updatePreview:function(){var a,b=this.model.attributes,c=this.model;void 0!==b&&(a="",void 0!==b.params.title&&b.params.title.length?a=b.params.title:"fusion_flip_box"==c.get("element_type")&&void 0!==b.params.title_front&&b.params.title_front.length?a=b.params.title_front:void 0!==b.params.image&&b.params.image.length?(a=b.params.image,-1!==a.indexOf("/")&&-1===a.indexOf("[")&&(a=a.split("/"),a=a.slice(-1)[0])):void 0!==b.params.video&&b.params.video.length?a=b.params.video:void 0!==b.params.element_content&&b.params.element_content.length&&(a=b.params.element_content),a=jQuery("<div/>").html(a).text(),(a=jQuery("<div/>").html(a).text())&&(a=a.length>15?a.substring(0,15)+"...":a,jQuery("li[data-cid="+c.get("cid")+"] .multi-element-child-name").text(a)))},removeView:function(a){a&&a.preventDefault(),this.remove(),this.model.destroy(),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.ColumnLibraryView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(a("#fusion-builder-column-library-template").html()),events:{"click .fusion-builder-column-layouts li":"addColumns","click .fusion_builder_custom_columns_load":"addCustomColumn","click .fusion_builder_custom_sections_load":"addCustomSection","click .fusion-builder-section-next-page":"addNextPage"},initialize:function(a){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeView),this.options=a},render:function(){return this.$el.html(this.template(this.model.toJSON())),FusionPageBuilderApp.showSavedElements("columns",this.$el.find("#custom-columns")),"container"===FusionPageBuilderApp.activeModal&&FusionPageBuilderApp.showSavedElements("sections",this.$el.find("#custom-sections")),this},addCustomColumn:function(b){var c,d,e;b&&b.preventDefault(),FusionPageBuilderApp.activeModal="column",!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,c=this.model,d=a(b.currentTarget).data("layout_id"),e=a(b.currentTarget).find(".fusion_module_title").text(),a(b.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),a(b.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),a.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_id:d},success:function(c){var d=JSON.parse(c);FusionPageBuilderApp.shortcodesToBuilder(d.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,a(b.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),a(b.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide()},complete:function(){c.unset("added"),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.added_custom_column+e,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}}))},addColumns:function(b){var c,d,e,f,g,h;b&&b.preventDefault(),FusionPageBuilderApp.activeModal="column",c=this,d=a(b.target).is("li")?a(b.target):a(b.target).closest("li"),e=d.data("layout").split(","),_.size(e),f=this.options.view,g=fusionAllElements.fusion_builder_column.params,_.each(e,function(a,b){var d,e={};_.each(g,function(a){h=_.isObject(a.value)?a.default:a.value,e[a.param_name]=h}),d={type:"fusion_builder_column",element_type:"fusion_builder_column",cid:FusionPageBuilderViewManager.generateCid(),parent:c.model.get("cid"),layout:a,view:f,params:e},c.collection.add([d])}),this.model.unset("added"),FusionPageBuilderEvents.trigger("fusion-columns-added"),b&&(fusionHistoryManager.turnOnTracking(),1==FusionPageBuilderApp.newContainerAdded?(fusionHistoryState=fusionBuilderText.added_section,FusionPageBuilderApp.newContainerAdded=!1):fusionHistoryState=fusionBuilderText.added_columns,FusionPageBuilderEvents.trigger("fusion-element-added"))},removeView:function(){this.remove()},addCustomSection:function(b){var c,d,e,f=this.model,g=this.model.get("parent"),h=FusionPageBuilderViewManager.getView(g);e=h.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=e.find(".fusion-builder-data-cid").data("cid"),b&&b.preventDefault(),void 0!==h&&h.removeContainer(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,c=a(b.currentTarget).data("layout_id"),d=a(b.currentTarget).find(".fusion_module_title").text(),a(b.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),a(b.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),a.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_id:c},success:function(c){var d=JSON.parse(c);FusionPageBuilderApp.shortcodesToBuilder(d.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,a(b.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),a(b.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide()},complete:function(){f.unset("added"),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.added_custom_section+d,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}}))},addNextPage:function(a){var b,c,d=this.model.get("parent"),e=FusionPageBuilderViewManager.getView(d),f={};a&&a.preventDefault(),b=e.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=b.find(".fusion-builder-data-cid").data("cid"),c=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_next_page",added:"manually",module_type:"fusion_builder_next_page",cid:c,params:f,view:e,appendAfter:b,created:"auto"}]),void 0!==e&&(FusionPageBuilderApp.targetContainerCID="",e.removeContainer()),FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}})})}(jQuery);var FusionPageBuilder=FusionPageBuilder||{},FusionPageBuilderEvents=_.extend({},Backbone.Events);!function(a){var b,c;a.fn.outerHTML=function(){return this.length?this[0].outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),b=c.innerHTML,c=null,b}(this[0]):this},fusionBuilderGetContent=function(b,c,d){var e;if(void 0===c&&(c=!1),void 0===d&&(d=!1),e=d||void 0===window.tinyMCE||!window.tinyMCE.get(b)||window.tinyMCE.get(b).isHidden()?a("#"+b).val().replace(/\r?\n/g,"\r\n"):window.tinyMCE.get(b).getContent(),c&&void 0!==window.tinyMCE&&(e=e.replace(/<p>\[/g,"["),e=e.replace(/\]<\/p>/g,"]")),void 0!==e)return e.trim()},b=a(".icon_select_container .icon_preview"),c=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),a(window).load(function(){a("#fusion_toggle_builder").data("enabled")&&a("#fusion_toggle_builder").trigger("click")}),a(document).ready(function(){function d(){var a=document.getElementById("fusion_builder_controls");fusionBuilderStickyHeader(a,jQuery("#wpadminbar").height())}function e(a){f(),FusionPageBuilderApp.initialBuilderLayout(),i.val("active"),k.show(),a.text(a.data("editor")),l.toggleClass("fusion_builder_hidden"),a.toggleClass("fusion_builder_is_active"),d()}function f(){FusionPageBuilderElements.reset(),FusionPageBuilderViewManager.set("elementCount",0),FusionPageBuilderViewManager.set("views",{}),a("#fusion_builder_container").html("")}function g(b){var c,d;f(),c=a("body"),d=0,window.wpActiveEditor="content",i.val("off"),k.hide(),j.text(j.data("builder")).toggleClass("fusion_builder_is_active"),l.toggleClass("fusion_builder_hidden"),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),d=c.scrollTop(),jQuery("html, body").scrollTop(d+1)}var h,i,j,k,l,m;a(document).click(function(b){a(b.target).parents(".column-sizes").length||a(b.target).hasClass("fusion-builder-resize-column")||a(".column-sizes").hide()}),FusionPageBuilder.AppView=window.wp.Backbone.View.extend({el:a("#fusion_builder_main_container"),template:FusionPageBuilder.template(a("#fusion-builder-app-template").html()),events:{"click .fusion-builder-layout-button-save":"saveLayout","click .fusion-builder-layout-button-load":"loadLayout","click .fusion-builder-layout-button-delete":"deleteLayout","click .fusion-builder-layout-buttons-clear":"clearLayout","click .fusion-builder-demo-button-load":"loadDemoPage","click .fusion-builder-layout-custom-css":"customCSS","click .fusion-builder-template-buttons-save":"saveTemplateDialog","click #fusion-builder-layouts .fusion-builder-modal-close":"hideLibrary","click .fusion-builder-library-dialog":"openLibrary","mouseenter .fusion-builder-layout-buttons-history":"showHistoryDialog","mouseleave .fusion-builder-layout-buttons-history":"hideHistoryDialog","click .fusion-builder-element-button-save":"saveElement","click #fusion-load-template-dialog":"loadPreBuiltPage","click .fusion-builder-layout-buttons-toggle-containers":"toggleAllContainers"},initialize:function(){this.builderActive=!1,this.ajaxurl=fusionBuilderConfig.ajaxurl,this.fusion_load_nonce=fusionBuilderConfig.fusion_load_nonce,this.fusion_builder_plugin_dir=fusionBuilderConfig.fusion_builder_plugin_dir,this.layoutIsLoading=!1,this.layoutIsSaving=!1,this.layoutIsDeleting=!1,this.parentRowId="",this.parentColumnId="",this.targetContainerCID="",this.activeModal="",this.innerColumn="",this.blankPage="",this.newLayoutLoaded=!1,this.newContainerAdded=!1,this.fullWidth=fusionBuilderConfig.full_width,this.shortcodeGenerator="",this.shortcodeGeneratorMultiElement="",this.shortcodeGeneratorMultiElementChild="",this.allowShortcodeGenerator="",this.shortcodeGeneratorActiveEditor="",this.shortcodeGeneratorEditorID="",this.manuallyAdded=!1,this.manualGenerator=!1,this.manualEditor="",this.fromExcerpt=!1,this.disable_encoding=fusionBuilderConfig.disable_encoding,this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.codeEditor="",this.MultiElementChildSettings=!1,this.listenTo(this.collection,"add",this.addBuilderElement),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-removed",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-show-loader",this.showLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-loader",this.hideLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-library",this.hideLibrary),this.listenTo(FusionPageBuilderEvents,"fusion-save-layout",this.saveLayout),this.listenTo(FusionPageBuilderEvents,"fusion-save-history-state",this.saveHistoryState),this.toggledContainers=!0,this.render(),a("#fusion_toggle_builder").hasClass("fusion_builder_is_active")&&this.initialBuilderLayout(!0),fusionHistoryManager.turnOnTracking(),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()},render:function(){return this.$el.html(this.template()),this.sortableContainers(),this},isTinyMceActive:function(){return"undefined"!=typeof tinyMCE&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()},base64Encode:function(a){var b,c,d,e,f,g,h,i,j,k=this._keyStr,l=0,m=0,n="",o=[];if(!a)return a;a=unescape(encodeURIComponent(a));do{b=a.charCodeAt(l++),c=a.charCodeAt(l++),d=a.charCodeAt(l++),i=b<<16|c<<8|d,e=i>>18&63,f=i>>12&63,g=i>>6&63,h=63&i,o[m++]=k.charAt(e)+k.charAt(f)+k.charAt(g)+k.charAt(h)}while(l<a.length);return n=o.join(""),j=a.length%3,(j?n.slice(0,j-3):n)+"===".slice(j||3)},base64Decode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=this._keyStr.indexOf(a.charAt(j++)),f=this._keyStr.indexOf(a.charAt(j++)),g=this._keyStr.indexOf(a.charAt(j++)),h=this._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=this.utf8Decode(i)},utf8Decode:function(a){for(var b,c="",d=0,e=0,f=0;d<a.length;)e=a.charCodeAt(d),e<128?(c+=String.fromCharCode(e),d++):e>191&&e<224?(f=a.charCodeAt(d+1),c+=String.fromCharCode((31&e)<<6|63&f),d+=2):(f=a.charCodeAt(d+1),b=a.charCodeAt(d+2),c+=String.fromCharCode((15&e)<<12|(63&f)<<6|63&b),d+=3);return c},fusionBuilderMCEremoveEditor:function(a){void 0!==window.tinyMCE&&(window.tinyMCE.execCommand("mceRemoveEditor",!1,a),void 0!==window.tinyMCE.get(a)&&window.tinyMCE.remove("#"+a))},fusion_builder_iconpicker:function(b,d,e,f){var g=fusionBuilderConfig.fontawesomeicons,h="";_.each(g,function(a){var c="";b==a&&(c="selected-element"),h+='<span class="icon_preview icon-'+a+" "+c+'"><i class="fa '+a+'" data-name="'+a+'"></i></span>'}),a(e).append(h),a(f).on("change paste keyup",function(){var d=a(this);c(function(){d.val()?(b=d.val().toLowerCase(),_.each(g,function(c){name=c.toLowerCase(),-1!==name.search(b)?a(d.parent().find(".icon_select_container .icon-"+name)).show():a(d.parent().find(".icon_select_container .icon-"+name)).hide()})):a(".icon_select_container .icon_preview").show()},500)})},fusionBuilderImagePreview:function(b){var c,d=b.siblings(".fusion-builder-upload-field"),e=d.siblings(".fusion-builder-upload-preview"),f=b.siblings(".upload-image-remove"),g=d.val().trim();if(c=0<=g.indexOf("<img")?g:'<img src="'+g+'" />',"image"===b.data("type")&&!b.hasClass("hide-edit-buttons")){if(""===g)return e.length&&(e.remove(),f.remove(),b.val("Upload Image")),void(a("#image_id").length&&a("#image_id").val(""));e.length||(b.siblings(".preview").before('<div class="fusion-builder-upload-preview"><strong class="fusion-builder-upload-preview-title">Preview</strong><div class="fusion-builder-preview-image"><img src="" width="300" height="300" /></div></div>'),b.after('<input type="button" class="upload-image-remove" value="Remove" />'),b.val("Edit"),e=d.siblings(".fusion-builder-upload-preview")),e.find("img").replaceWith(c)}},FusionBuilderActivateUpload:function(b){b.click(function(b){var c,d,e,f,g,h=!1,i=!1,j="",k="",l="",m=[];return b&&b.preventDefault(),c=a(this),"fusion-multiple-upload"===c.data("id")&&(h=!0,e=fusionAllElements[c.data("element")].params[c.data("param")].value),"fusion-multiple-images"===c.data("id")&&(i=!0,f=jQuery(c.next(".fusion-multiple-image-container"))[0],g=jQuery(c).prev(".fusion-multi-image-input")),d=wp.media.frames.file_frame=wp.media({library:{type:c.data("type")},title:c.data("title"),multiple:!(!h&&!i)&&"between",frame:"post",className:"media-frame mode-select fusion-builder-media-dialog "+c.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0}),i&&"fusion_gallery"==c.data("element")&&(k=g.val().split(","),m=[],l="",jQuery.each(k,function(a,b){""!==b&&"NaN"!==b&&(l=wp.media.attachment(b),l.fetch(),m.push(l))}),wp.media._galleryDefaults.link="none",wp.media._galleryDefaults.size="thumbnail",d.options.syncSelection=!0,m.length?d.options.state="gallery-edit":d.options.state="gallery"),d.on("open",function(){var b,e,f=d.state().get("selection"),g=d.state().get("library");i?("fusion_gallery"===c.data("element")&&"gallery-edit"===d.options.state||a(".fusion-builder-media-dialog").addClass("hide-menu"),f.add(m),g.add(m)):(e=c.parents(".fusion-builder-module-settings").find("#image_id").val(),b=wp.media.attachment(e),a(".fusion-builder-media-dialog").addClass("hide-menu"),e&&(b.fetch(),f.add(b?[b]:[])))}),i&&"fusion_gallery"==c.data("element")&&d.on("update",function(a){var b=d.state(),c="",e="";c=a.map(function(a){var c=a.id;b.display(a).toJSON();return a.attributes.sizes&&void 0!==a.attributes.sizes.thumbnail?e=a.attributes.sizes.thumbnail.url:a.attributes.url&&(e=a.attributes.url),i&&(j+='<div class="fusion-multi-image" data-image-id="'+c+'">',j+='<img src="'+e+'"/>',j+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',j+="</div>"),a.id}),g.val(c),jQuery(f).html(j)}),d.on("select insert",function(){var b,k,l,m,n,o=d.state();void 0===o.get("selection")?b=jQuery(d.$el).find("#embed-url-field").val():(l=o.get("selection").map(function(a){return a.id}),i&&g.val(l),h&&(m=jQuery(document).find(".fusion-builder-sortable-options li:first-child"),m.length&&(n=FusionPageBuilderElements.find(function(a){return a.get("cid")==m.data("cid")}))&&void 0===n.attributes.params[c.data("param")]&&jQuery(document).find(".fusion-builder-sortable-options li:first-child .fusion-builder-multi-setting-remove").trigger("click")),o.get("selection").map(function(a){var d=a.toJSON(),f=o.display(a).toJSON();k=d.id,d.sizes&&d.sizes[f.size]&&d.sizes[f.size].url?b=d.sizes[f.size].url:d.url&&(b=d.url),i&&(j+='<div class="fusion-multi-image" data-image-id="'+k+'">',j+='<img src="'+b+'"/>',j+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',j+="</div>"),h&&(fusionAllElements[c.data("element")].params[c.data("param")].value=b,jQuery(".fusion-builder-add-multi-child").trigger("click"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),fusionAllElements[c.data("element")].params[c.data("param")].value=e)})),jQuery(f).html(j),h||i||(c.siblings(".fusion-builder-upload-field").val(b).trigger("change"),a("#image_id").length&&a("#image_id").val(k),FusionPageBuilderApp.fusionBuilderImagePreview(c))}),d.open(),!1}),b.siblings(".fusion-builder-upload-field").on("input",function(){FusionPageBuilderApp.fusionBuilderImagePreview(a(this).siblings(".fusion-builder-upload-button"))}),b.siblings(".fusion-builder-upload-field").each(function(){FusionPageBuilderApp.fusionBuilderImagePreview(a(this).siblings(".fusion-builder-upload-button"))}),jQuery("body").on("click",".fusion-multi-image-remove",function(a){var b,c,d,e=jQuery(this).parents(".fusion-multiple-upload-images").find(".fusion-multi-image-input");c=jQuery(this).parent(".fusion-multi-image").data("image-id"),b=e.val().split(",").map(function(a){return parseInt(a)}),d=b.indexOf(c),-1!==d&&b.splice(d,1),b=b.join(","),e.val(b),jQuery(this).parent(".fusion-multi-image").remove()})},fusionBuilderActivateLinkSelector:function(b){var c,d,e,f=jQuery("#wp-link-submit"),g=jQuery(".wp-link-text-field"),h=jQuery(".link-target"),i=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),j=window.wpLinkL10n;jQuery(b).click(function(b){i.insertBefore(f),c=jQuery(b.target).prev(".fusion-builder-link-field"),e=c.val(),f.hide(),g.hide(),h.hide(),i.show(),d=!window.wpLink&&a.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:j.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink,d.fusionUpdateLink=function(a){b.preventDefault(),b.stopImmediatePropagation(),b.stopPropagation(),e=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),c.val(e),f.show(),g.show(),h.show(),a.remove(),jQuery("#wp-link-cancel").unbind("click"),d.close(),window.wpLink.textarea=""},d.open("content"),jQuery("#wp-link-url").val(e)}),jQuery("body").on("click","#fusion-link-submit",function(a){d.fusionUpdateLink(jQuery(this))}),jQuery("body").on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(a){f.show(),g.show(),h.show(),i.remove()})},fusionBuilderSetContent:function(b,c){void 0!==window.tinyMCE&&window.tinyMCE.get(b)&&!window.tinyMCE.get(b).isHidden()?(window.tinyMCE.get(b).getParam("wpautop",!0)&&void 0!==window.switchEditors&&(c=window.switchEditors.wpautop(c)),window.tinyMCE.get(b).setContent(c,{format:"html"})):a("#"+b).val(c)},layoutLoaded:function(){this.newLayoutLoaded=!0},clearLayout:function(a){if(a&&a.preventDefault(),
0==confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this_layout))return!1;this.blankPage=!0,this.clearBuilderLayout(!0),fusionHistoryManager.clearEditor("blank")},showHistoryDialog:function(a){a&&a.preventDefault(),this.$el.find(".fusion-builder-history-list").show()},hideHistoryDialog:function(a){a&&a.preventDefault(),this.$el.find(".fusion-builder-history-list").hide()},saveTemplateDialog:function(b){b&&b.preventDefault(),this.showLibrary(),a("#fusion-builder-layouts-templates-trigger").click()},loadPreBuiltPage:function(b){b&&b.preventDefault(),this.showLibrary(),a("#fusion-builder-layouts-demos-trigger").click()},saveLayout:function(b){var c,d,e,f,g,h,i,j,k,l=[];b&&b.preventDefault(),jQuery('input[id^="pyre_"], select[id^="pyre_"]').each(function(a){j=jQuery(this).attr("id"),k=jQuery(this).val(),void 0!==j&&void 0!==k&&(l[a]=[j,k])}),c=fusionBuilderGetContent("content"),d=a("#new_template_name").val(),e=a("#fusion-builder-layouts-templates .fusion-page-layouts"),f=a("#fusion_builder_main_container").data("post-id"),g=a("#fusion-builder-layouts-templates .fusion-page-layouts .fusion-empty-library-message"),h=a("#fusion-custom-css-field").val(),i=a("#page_template").val(),""!==d?(a.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:d,fusion_layout_content:c,fusion_layout_post_type:"fusion_template",fusion_current_post_id:f,fusion_custom_css:h,fusion_page_template:i,fusion_options:l},complete:function(a){e.prepend(a.responseText),g.hide()}}),a("#new_template_name").val("")):alert(fusionBuilderText.please_enter_template_name)},saveElement:function(b){var c,d;b&&b.preventDefault(),a(b.currentTarget).data("element-type"),c=a(b.currentTarget).data("element-cid"),d=FusionPageBuilderViewManager.getView(c),d.saveElement()},loadLayout:function(b){var c,d,e,f;b&&b.preventDefault(),!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,c=a(b.currentTarget).closest("li"),d=a(b.currentTarget).data("load-type"),e=fusionBuilderGetContent("content"),f=jQuery("#fusion-custom-css-field").val(),a.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:c.data("layout_id")},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),a("body").removeClass("fusion_builder_inner_row_no_scroll"),a(".fusion_builder_modal_inner_row_overlay").remove(),a("#fusion-builder-layouts").hide()},success:function(b){var c;FusionPageBuilderApp.layoutLoaded(),c=JSON.parse(b),"above"===d?(e=c.post_content+e,void 0!==c.custom_css&&a("#fusion-custom-css-field").val(c.custom_css+"\n"+f)):"below"===d?(e+=c.post_content,void 0!==c.custom_css&&(f.length?a("#fusion-custom-css-field").val(f+"\n"+c.custom_css):a("#fusion-custom-css-field").val(c.custom_css))):(e=c.post_content,void 0!==c.custom_css&&a("#fusion-custom-css-field").val(c.custom_css),jQuery.each(c.post_meta,function(a,b){jQuery("#"+a).val(b).trigger("change")})),FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.createBuilderLayout(e),void 0!==c.page_template&&a("#page_template").val(c.page_template),FusionPageBuilderApp.layoutIsLoading=!1},complete:function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}}))},loadDemoPage:function(b){var c,d,e,f;if(b&&b.preventDefault(),0==confirm(fusionBuilderText.importing_single_page))return!1;!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,c=a(b.currentTarget).data("page-name"),d=a(b.currentTarget).data("demo-name"),e=a(b.currentTarget).data("post-id"),a.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_demo",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,page_name:c,demo_name:d,post_id:e},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),a("body").removeClass("fusion_builder_inner_row_no_scroll"),a(".fusion_builder_modal_inner_row_overlay").remove(),a("#fusion-builder-layouts").hide()},success:function(b){var c,d;FusionPageBuilderApp.layoutLoaded(),c=JSON.parse(b),f=c.post_content,FusionPageBuilderApp.clearBuilderLayout(!1),FusionPageBuilderApp.createBuilderLayout(f),void 0!==c.page_template&&a("#page_template").val(c.page_template),d=c.meta,_.each(d,function(b,c){a("#"+c).val(b).trigger("change")}),FusionPageBuilderApp.layoutIsLoading=!1},complete:function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}}))},deleteLayout:function(b){var c;if(b&&(b.preventDefault(),0==confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this)))return!1;!0!==this.layoutIsDeleting&&(this.layoutIsDeleting=!0,c=a(b.currentTarget).closest("li"),a.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_delete_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:c.data("layout_id")},success:function(b){var d;d=c.parents("#fusion-builder-layouts-templates").length?"templates":"elements",c.remove(),FusionPageBuilderApp.layoutIsDeleting=!1,a("#fusion-builder-layouts-"+d+" .fusion-page-layouts").find("li").length||a("#fusion-builder-layouts-"+d+" .fusion-page-layouts .fusion-empty-library-message").show()}}))},openLibrary:function(b){b&&b.preventDefault(),this.showLibrary(),a("#fusion-builder-layouts-templates-trigger").click()},showLibrary:function(b){b&&b.preventDefault(),a("#fusion-builder-layouts").show(),a("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>')},hideLibrary:function(b){b&&b.preventDefault(),a("#fusion-builder-layouts").hide(),a("body").removeClass("fusion_builder_inner_row_no_scroll"),a(".fusion_builder_modal_inner_row_overlay").remove(),a(".fusion-save-element-fields").remove()},showLoader:function(){a("#fusion_builder_main_container").css("height","148px"),a("#fusion_builder_container").hide(),a("#fusion-loader").fadeIn("fast")},hideLoader:function(){a("#fusion_builder_container").fadeIn("fast"),a("#fusion_builder_main_container").removeAttr("style"),a("#fusion-loader").fadeOut("fast")},sortableContainers:function(){this.$el.sortable({handle:".fusion-builder-section-header",items:".fusion_builder_container, .fusion-builder-next-page",cancel:".fusion-builder-section-name, .fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-element",cursor:"move",update:function(a,b){fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved_container,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},initialBuilderLayout:function(a){FusionPageBuilderViewManager.removeViews(),FusionPageBuilderEvents.trigger("fusion-show-loader"),setTimeout(function(){var b=fusionBuilderGetContent("content",!0,a),c="",d="",e="";try{b=FusionPageBuilderApp.validateContent(b),FusionPageBuilderApp.createBuilderLayout(b),FusionPageBuilderEvents.trigger("fusion-hide-loader")}catch(a){FusionPageBuilderApp.fusionBuilderSetContent("content",b),jQuery("#fusion_toggle_builder").trigger("click"),c=FusionPageBuilderApp.$el.find("#content-error"),d=FusionPageBuilderApp.$el,e=c.clone(),c.dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,buttons:{OK:function(){jQuery(this).dialog("close")}},close:function(){d.append(e)}}),c.dialog("open")}},50)},validateContent:function(a){function b(a){return"$$"}var c,d,e,f=""==a,g="",h=[],i=[];if(-1!==a.indexOf("[fullwidth"))throw"Avada 4.0.3 or earlier fullwidth container used!";return f||(a=a.replace(/\[fusion\_text \/\]/g,"[fusion_text][/fusion_text]").replace(/\[\/fusion\_text\]\[\/fusion\_text\]/g,"[/fusion_text]"),a=a.replace(/\$\$/g,"&#36;&#36;"),g=a,g=wp.shortcode.replace("fusion_builder_container",g,function(a){return"|"}),g=wp.shortcode.replace("fusion_builder_next_page",g,function(a){return"|"}),g=g.trim().split("|"),_.each(g,function(b){""!==b.trim()&&(a=a.replace(b,'[fusion_builder_container hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]'+b+"[/fusion_builder_row][/fusion_builder_container]"))}),g=wp.shortcode.replace("fusion_builder_container",a,function(a){i.push(a.content)}),_.each(i,function(b){b=wp.shortcode.replace("fusion_builder_row",b,function(a){return a.content}),b=wp.shortcode.replace("fusion_builder_column",b,function(a){return"|"}),b=b.trim().split("|"),_.each(b,function(b){""!==b.trim()&&"[fusion_builder_row][/fusion_builder_row]"!==b.trim()&&(d='[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]'+b+"[/fusion_builder_column]",a=a.replace(b,d))})}),g=wp.shortcode.replace("fusion_builder_column_inner",a,function(a){h.push(a.content)}),g=wp.shortcode.replace("fusion_builder_column",a,function(a){h.push(a.content)}),_.each(h,function(b){c=fusionAllElements,_.each(c,function(a){void 0===a.generator_only&&(b=wp.shortcode.replace(a.shortcode,b,function(a){return"|"}))}),b=b.trim().split("|"),_.each(b,function(b){""!==b.trim()&&(e="@=%~@","@"===b.slice(-1)&&(e="#=%~#"),a=a.replace(b,"[fusion_text]"+b.slice(0,-1)+e+b.slice(-1)+"[/fusion_text]"))})}),a=a.replace(/@=%~@/g,"").replace(/#=%~#/g,""),a=wp.shortcode.replace("fusion_text",a,function(a){if(c=fusionAllElements,g=a.content,_.each(c,function(a){void 0===a.generator_only&&(g=wp.shortcode.replace(a.shortcode,g,function(a){return"|"}))}),!g.replace(/\|/g,"").length)return a.content})),a=a.replace(/&#36;&#36;/g,b)},clearBuilderLayout:function(b){this.$el.find(".fusion-builder-blank-page-content").each(function(){var b=a(this),c=FusionPageBuilderViewManager.getView(b.data("cid"));void 0!==c&&c.removeBlankPageHelper()}),this.$el.find(".fusion-builder-section-content").each(function(){var b=a(this),c=FusionPageBuilderViewManager.getView(b.data("cid"));void 0!==c&&c.removeContainer()}),b&&!0===this.blankPage&&(this.$el.find(".fusion-builder-blank-page-content").length||this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]"),this.blankPage=!1)},createBuilderLayout:function(a){this.shortcodesToBuilder(a),this.builderToShortcodes()},shortcodesToBuilder:function(a,b){var c,d,e,f,g;if(""===a&&!this.$el.find(".fusion-builder-blank-page-content").length)return void this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]");c=this,g=_.keys(fusionAllElements).join("|"),d=window.wp.shortcode.regexp(g),e=this.regExpShortcode(g),f=a.match(d),_.each(f,function(a){var f,g,h,i,j,k,l,m=a.match(e),n=m[2],o=""!==m[3]?window.wp.shortcode.attrs(m[3]):"",p=m[5],q=FusionPageBuilderViewManager.generateCid(),r={params:{}},s=void 0!==p&&""!==p&&p.match(d);if(f={type:n,element_type:n,cid:q,created:"manually",multi:"",params:{},allow_generator:void 0!==fusionAllElements[n].allow_generator?fusionAllElements[n].allow_generator:""},"fusion_builder_container"===n&&"fusion_builder_next_page"===n||(f.parent=b),"fusion_builder_container"!==n&&"fusion_builder_row"!==n&&"fusion_builder_column"!==n&&"fusion_builder_column_inner"!==n&&"fusion_builder_row_inner"!==n&&"fusion_builder_blank_page"!==n&&"fusion_builder_next_page"!==n&&(-1===n.indexOf("fusion_")&&-1===n.indexOf("layerslider")&&-1===n.indexOf("rev_slider")&&void 0===fusionAllElements[n]||(f.type="element")),_.isObject(o.named)){for(g in o.named)h=g,"fusion_builder_column"!==n&&"fusion_builder_column_inner"!==n||"type"!==h||(h="layout",r[h]=o.named[g]),r.params[h]=o.named[g],"fusion_products_slider"===n&&"cat_slug"===g&&(r.params.cat_slug=o.named[g].replace(/\|/g,",")),"gradient_colors"===g&&(delete r.params[h],-1!==o.named[g].indexOf("|")?(r.params.button_gradient_top_color=o.named[g].split("|")[0].replace("transparent","rgba(255,255,255,0)"),r.params.button_gradient_bottom_color=o.named[g].split("|")[1]?o.named[g].split("|")[1].replace("transparent","rgba(255,255,255,0)"):o.named[g].split("|")[0].replace("transparent","rgba(255,255,255,0)")):r.params.button_gradient_bottom_color=r.params.button_gradient_top_color=o.named[g].replace("transparent","rgba(255,255,255,0)")),"gradient_hover_colors"===g&&(delete r.params[h],-1!==o.named[g].indexOf("|")?(r.params.button_gradient_top_color_hover=o.named[g].split("|")[0].replace("transparent","rgba(255,255,255,0)"),r.params.button_gradient_bottom_color_hover=o.named[g].split("|")[1]?o.named[g].split("|")[1].replace("transparent","rgba(255,255,255,0)"):o.named[g].split("|")[0].replace("transparent","rgba(255,255,255,0)")):r.params.button_gradient_bottom_color_hover=r.params.button_gradient_top_color_hover=o.named[g].replace("transparent","rgba(255,255,255,0)")),"overlay_color"===g&&""!==o.named[g]&&"fusion_builder_container"===n&&(delete r.params[h],l=void 0!==o.named.overlay_opacity?o.named.overlay_opacity:1,r.params.background_color=jQuery.Color(o.named[g]).alpha(l).toRgbaString()),"overlay_opacity"===g&&delete r.params[h],"scrolling"===g&&"fusion_blog"===n&&(delete r.params.paging,"no"===(void 0!==o.named.paging?o.named.paging:"")&&"pagination"==o.named.scrolling&&(r.params.scrolling="no")),"fusion_portfolio"===n&&("layout"===g&&("grid"===o.named[g]&&o.named.hasOwnProperty("boxed_text")?o.named.boxed_text="no_text":"grid-with-text"===o.named[g]&&(r.params[g]="grid")),"boxed_text"===g&&(r.params.text_layout=o.named[g],delete r.params[g]),"content_length"===g&&"full-content"===o.named[g]&&(r.params[g]="full_content"));f=_.extend(f,r)}s||"fusion_builder_column"===n||(f.params.element_content=p),n in fusionMultiElements&&(f.multi="multi_element_parent"),void 0!==fusionAllElements[n].option_dependency&&(i=fusionAllElements[n].option_dependency,j=r.params[i],k=r.params.element_content,r.params[j]=k),s&&"fusion_builder_container"!==n&&"fusion_builder_row"!==n&&"fusion_builder_row_inner"!==n&&"fusion_builder_column"!==n&&"fusion_builder_column_inner"!==n&&"fusion_builder_next_page"!==n&&(f.params.element_content=p),c.collection.add([f]),s&&("fusion_builder_container"!=n&&"fusion_builder_row"!=n&&"fusion_builder_row_inner"!=n&&"fusion_builder_column"!=n&&"fusion_builder_column_inner"!=n||c.shortcodesToBuilder(p,q))})},addBuilderElement:function(b){var c,d,e,f,g={model:b,collection:FusionPageBuilderElements};switch(b.get("type")){case"fusion_builder_blank_page":c=new FusionPageBuilder.BlankPageView(g),FusionPageBuilderViewManager.addView(b.get("cid"),c),_.isUndefined(b.get("view"))?this.$el.find("#fusion_builder_container").append(c.render().el):b.get("view").$el.after(c.render().el);break;case"fusion_builder_container":""!==FusionPageBuilderApp.targetContainerCID&&(b.attributes.view=FusionPageBuilderViewManager.getView(FusionPageBuilderApp.targetContainerCID),FusionPageBuilderApp.targetContainerCID=""),c=new FusionPageBuilder.ContainerView(g),FusionPageBuilderViewManager.addView(b.get("cid"),c),_.isUndefined(b.get("view"))?(this.$el.find("#fusion_builder_container").append(c.render().el),this.$el.find(".fusion_builder_blank_page").remove()):b.get("view").$el.after(c.render().el),"manually"!==b.get("created")&&c.addRow(),(!_.isUndefined(b.attributes.params.admin_toggled)&&"no"===b.attributes.params.admin_toggled||_.isUndefined(b.attributes.params.admin_toggled))&&(FusionPageBuilderApp.toggledContainers=!1,a(".fusion-builder-layout-buttons-toggle-containers").find("span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"));break;case"fusion_builder_row":c=new FusionPageBuilder.RowView(g),FusionPageBuilderViewManager.addView(b.get("cid"),c),FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-section-content").append(c.render().el):FusionPageBuilderViewManager.getView(b.get("parent")).$el.find("> .fusion-builder-add-element").hide().end().append(c.render().el),"manually"===b.get("created")&&"row_inner"===b.get("element_type")&&b.set("view",FusionPageBuilderViewManager.getView(b.get("parent")),{silent:!0});break;case"fusion_builder_row_inner":c=new FusionPageBuilder.InnerRowView(g),FusionPageBuilderViewManager.addView(b.get("cid"),c),_.isUndefined(b.get("appendAfter"))?FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-section-content").append(c.render().el):FusionPageBuilderViewManager.getView(b.get("parent")).$el.find("> .fusion-builder-add-element").before(c.render().el):(b.get("appendAfter").after(c.render().el),b.unset("appendAfter")),"manually"===b.get("created")&&"row_inner"===b.get("element_type")&&b.set("view",FusionPageBuilderViewManager.getView(b.get("parent")),{silent:!0});break;case"fusion_builder_column":b.get("layout")&&(g.className="fusion-builder-column fusion-builder-column-outer fusion-builder-column-"+b.get("layout"),c=new FusionPageBuilder.ColumnView(g),_.isUndefined(b.get("cloned"))||!0!==b.get("cloned")||(b.targetElement=c.$el,b.unset("cloned")),FusionPageBuilderViewManager.addView(b.get("cid"),c),_.isUndefined(b.get("targetElement"))||void 0!==b.get("from")?(FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-row-container").append(c.render().el),b.unset("from")):b.get("targetElement").after(c.render().el));break;case"fusion_builder_column_inner":g.className="fusion-builder-column fusion-builder-column-inner fusion-builder-column-"+b.get("layout"),c=new FusionPageBuilder.NestedColumnView(g),FusionPageBuilderViewManager.addView(b.get("cid"),c),FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-row-container-inner").append(c.render().el);break;case"element":g.attributes={"data-cid":b.get("cid")},void 0!==b.get("multi")&&"multi_element_child"===b.get("multi")?(c=new FusionPageBuilder.MultiElementSortableChild(g),b.targetElement=c.$el,b.attributes.view.child_views.push(c),FusionPageBuilderViewManager.addView(b.get("cid"),c),_.isUndefined(b.get("targetElement"))?FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-sortable-options").append(c.render().el):b.get("targetElement").after(c.render().el),_.isUndefined(b.get("titleLabel"))||(_.isUndefined(b.get("cloned"))||c.$el.find(".multi-element-child-name").text(b.get("titleLabel")),b.unset("cloned"))):(FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),c=new FusionPageBuilder.ElementView(g),d=this.collection.find(function(a){return a.get("cid")==b.get("parent")}),void 0!==d&&"fusion_builder_column_inner"===d.get("type")?_.isUndefined(b.get("targetElement"))||void 0!==b.get("from")?FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-add-element").before(c.render().el):b.get("targetElement").after(c.render().el):_.isUndefined(b.get("targetElement"))||void 0!==b.get("from")?FusionPageBuilderViewManager.getView(b.get("parent")).$el.find(".fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)").before(c.render().el):b.get("targetElement").after(c.render().el),FusionPageBuilderViewManager.addView(b.get("cid"),c),"manually"==b.get("added")?(g.attributes={"data-modal_view":"element_settings"},c=new FusionPageBuilder.ModalView(g),a("body").append(c.render().el)):(e=b.get("element_type"),void 0!==fusionAllElements[e].preview&&(f=new FusionPageBuilder.ElementPreviewView(g),c.$el.find(".fusion-builder-module-preview").append(f.render().el))));break;case"generated_element":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),"fusion_builder_column_inner"!==b.get("element_type")&&"fusion_builder_column"!==b.get("element_type")&&(g.attributes={"data-modal_view":"element_settings"},c=new FusionPageBuilder.ModalView(g),a("body").append(c.render().el));break;case"fusion_builder_next_page":c=new FusionPageBuilder.NextPage(g),FusionPageBuilderViewManager.addView(b.get("cid"),c),_.isUndefined(b.get("appendAfter"))?a(".fusion_builder_container:last-child").after(c.render().el):b.get("appendAfter").next().next().hasClass("fusion-builder-next-page")||b.get("appendAfter").after(c.render().el)}},regExpShortcode:_.memoize(function(a){return new RegExp("\\[(\\[?)("+a+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)")}),findShortcodeMatches:function(a,b){var c,d;return _.isObject(a)&&(a=a.value),c="",a=void 0!==a?a:"",d=window.wp.shortcode.regexp(b),new RegExp("\\[(\\[?)("+b+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)"),void 0!==a&&""!==a&&(c=a.match(d)),c},builderToShortcodes:function(){var b="",c=this;this.$el.find(".fusion_builder_container").each(function(){var d=a(this).find(".fusion-builder-section-content");b+=c.generateElementShortcode(a(this),!0),d.find(".fusion_builder_row").each(function(){var c=a(this);b+="[fusion_builder_row]",c.find(".fusion-builder-column-outer").each(function(){var c=a(this),d=c.data("cid"),e=FusionPageBuilderViewManager.getView(d);b+=e.getColumnContent(c)}),b+="[/fusion_builder_row]"}),b+="[/fusion_builder_container]",a(this).next().hasClass("fusion-builder-next-page")&&(b+="[fusion_builder_next_page]")}),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",b),FusionPageBuilderEvents.trigger("fusion-save-history-state")},500)},saveHistoryState:function(){!0===this.newLayoutLoaded&&(fusionHistoryManager.clearEditor(),this.newLayoutLoaded=!1),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()},generateElementShortcode:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x="",y="",z="";!0===d?e=b:(f=b,g=void 0===f.data("cid")?f.find(".fusion-builder-data-cid").data("cid"):f.data("cid"),e=FusionPageBuilderElements.find(function(a){return a.get("cid")==g})),h=void 0!==e?e.get("element_type"):"undefined",z="",i="",z=e.attributes,j=void 0!==fusionAllElements[h].remove_from_atts?fusionAllElements[h].remove_from_atts:"",j.push("undefined"),k=void 0!==fusionAllElements[h].option_dependency?fusionAllElements[h].option_dependency:"";for(m in z)if("params"===(o=m))if(p=void 0!==e.get(o)?e.get(o):"","params"===o)for(q in p)r=q,"element_content"===r?(s=void 0!==p[q]?p[q]:"",y=s,void 0!==p[k]&&(k=fusionAllElements[h].option_dependency,l=void 0!==p[k]?p[k]:"",y=p[l])):(t="",""!==k&&(n=r,l=void 0!==p[k]?p[k]:"",void 0!==fusionAllElements[h].params[n]&&void 0!==fusionAllElements[h].params[n].dependency&&(u=fusionAllElements[h].params[n].dependency,v=void 0!==u.element?u.element:"",w=void 0!==u.value?u.value:"",v===k&&w!==l&&(t="",t=n))),a.inArray(q,j)>-1||t===q||(s=void 0!==p[q]?p[q]:"",null===s&&(s=""),x+=" "+q+'="'+s+'"'));else""!==p&&(x+=" "+o+'="'+p+'"');return i="["+h+x,""===y&&"fusion_text"!==h&&"fusion_code"!==h&&void 0!==z.type&&"element"===z.type?(c=!0,i+=" /]"):i+="]",c||(i+=y+"[/"+h+"]"),i},customCSS:function(b){b&&b.preventDefault(),a(".fusion-custom-css").slideToggle()},toggleAllContainers:function(b){var c,d,e=this;b&&b.preventDefault(),c=a(".fusion-builder-layout-buttons-toggle-containers").find("span"),c.hasClass("dashicons-arrow-up")?(c.removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){var a;d=jQuery(this).find(".fusion-builder-data-cid").data("cid"),a=e.collection.find(function(a){return a.get("cid")==d}),a.attributes.params.admin_toggled="yes",jQuery(this).addClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down")})):(c.addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){var a;d=jQuery(this).find(".fusion-builder-data-cid").data("cid"),a=e.collection.find(function(a){return a.get("cid")==d}),a.attributes.params.admin_toggled="no",jQuery(this).removeClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down")})),FusionPageBuilderEvents.trigger("fusion-element-edited")},showSavedElements:function(a,b){var c,d=jQuery("#fusion-builder-layouts-"+a).find(".fusion-page-layouts").clone();d.find("li").each(function(){c=jQuery(this).find(".fusion-builder-demo-button-load").attr("data-post-id"),jQuery(this).find(".fusion-layout-buttons").remove(),jQuery(this).find("h4").attr("class","fusion_module_title"),jQuery(this).attr("data-layout_id",c),jQuery(this).addClass("fusion_builder_custom_"+a+"_load"),""!==jQuery(this).attr("data-layout_type")&&jQuery(this).addClass("fusion-element-type-"+jQuery(this).attr("data-layout_type"))}),b.append('<div id="fusion-loader"><span class="fusion-builder-loader"></span></div>'),b.append('<ul class="fusion-builder-all-modules">'+d.html()+"</div>")},rangeOptionPreview:function(b){b.find(".fusion-range-option").each(function(){a(this).next().html(a(this).val()),a(this).on("change mousemove",function(){a(this).next().html(a(this).val())})})},checkOptionDependency:function(b,c,d){function e(a,b,c){return i=!1,"=="==c&&a==b&&(i=!0),"!="==c&&a!=b&&(i=!0),">"==c&&a>b&&(i=!0),"<"==c&&a<b&&(i=!0),i}var f,g,h,i,j,k,l,m,n={},o="";void 0!==b.shortcode&&"fusion_section_separator"===b.shortcode&&(k=c.find("#divider_type"),l=k.parents("ul").find('li[data-option-id="divider_candy"]').find(".divider_candy").find('.ui-button[data-value="bottom,top"]'),m=k.parents("ul").find('li[data-option-id="divider_position"]').find(".divider_position").find('.ui-button[data-value="center"]'),"triangle"!==k.val()?l.hide():l.show(),"bigtriangle"!==k.val()?m.hide():m.show(),k.on("change paste keyup",function(){"triangle"!==jQuery(this).val()?l.hide():l.show(),"bigtriangle"!==jQuery(this).val()?(m.hide(),m.hasClass("ui-state-active")&&m.prev().click()):m.show()})),jQuery.each(b.params,function(b,g){void 0!==g.dependency&&(h=b,j=[],jQuery.each(g.dependency,function(a,b){0>o.indexOf("#"+b.element)&&(o+=", #"+b.element),void 0===n[b.element]?n[b.element]=[{option:h,or:g.or}]:n[b.element].push({option:h,or:g.or}),f="parent_"===b.element.substring(0,7)?"object"==typeof d&&d[b.element.replace(b.element.substring(0,7),"")]?d[b.element.replace(b.element.substring(0,7),"")]:"":c.find("#"+b.element).val(),j.push(e(f,b.value,b.operator))}),-1===a.inArray(!1,j)&&void 0===g.or?c.find("#"+b).parents(".fusion-builder-option").fadeIn(300):-1!==a.inArray(!0,j)&&void 0!==g.or?c.find("#"+b).parents(".fusion-builder-option").fadeIn(300):c.find("#"+b).parents(".fusion-builder-option").hide())}),o.length&&c.on("change paste keyup",o.substring(2),function(){g=jQuery(this).attr("id"),jQuery.each(n[g],function(g,h){j=[],jQuery.each(b.params[h.option].dependency,function(a,b){f="parent_"===b.element.substring(0,7)?"object"==typeof d&&d[b.element.replace(b.element.substring(0,7),"")]?d[b.element.replace(b.element.substring(0,7),"")]:"":c.find("#"+b.element).val(),j.push(e(f,b.value,b.operator))}),-1===a.inArray(!1,j)&&void 0===h.or?c.find("#"+h.option).parents(".fusion-builder-option").fadeIn(300):-1!==a.inArray(!0,j)&&void 0!==h.or?c.find("#"+h.option).parents(".fusion-builder-option").fadeIn(300):c.find("#"+h.option).parents(".fusion-builder-option").hide()})})}}),FusionPageBuilderApp=new FusionPageBuilder.AppView({model:FusionPageBuilder.Element,collection:FusionPageBuilderElements}),i=a("#fusion_use_builder"),j=a("#fusion_toggle_builder"),k=a("#fusion_builder_layout"),l=a("#fusion_main_editor_wrap"),j.hasClass("fusion_builder_is_active")&&(k.show(),FusionPageBuilderApp.builderActive=!0,d()),j.click(function(b){var c;b&&b.preventDefault(),c=a(this).hasClass("fusion_builder_is_active"),c?(g(a(this)),FusionPageBuilderApp.builderActive=!1):(e(a(this)),FusionPageBuilderApp.builderActive=!0)}),m=a("body"),m.on("click",".upload-image-remove",function(b){var c,d,e;b&&b.preventDefault(),c=a(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-field"),d=a(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-preview"),e=a(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-button"),c.val("").trigger("change"),e.val("Upload Image"),d.remove(),a("#image_id").length&&a("#image_id").val(""),jQuery(this).remove()}),a(".fusion-builder-history-list li").live("click",function(b){var c;b&&b.preventDefault(),c=a(b.currentTarget).data("state-id"),fusionHistoryManager.historyStep(c)}),a(".fusion-tabs-menu a").live("click",function(b){var c;b&&b.preventDefault(),a(this).parent().addClass("current").removeClass("inactive"),a(this).parent().siblings().removeClass("current").addClass("inactive"),c=a(this).attr("href"),a(this).parents(".fusion-builder-modal-container").find(".fusion-tab-content").not(c).css("display","none"),a(".fusion-builder-layouts-tab").hide(),"#design"===c&&a(this).parents(".fusion-builder-modal-container").length?a(this).parents(".fusion-builder-modal-container").find(c).fadeIn("fast"):a(c).fadeIn("fast")}),a(".fusion_builder_modal_overlay").live("click",function(){FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),FusionPageBuilderEvents.trigger("fusion-close-modal")}),a(".fusion_builder_modal_inner_row_overlay").live("click",function(){FusionPageBuilderEvents.trigger("fusion-close-inner-modal"),FusionPageBuilderEvents.trigger("fusion-hide-library")}),h=a(".fusion-builder-demo-select").val(),a("#fusion-builder-layouts-demos .demo-"+h).show(),a(".fusion-builder-demo-select").live("change",function(b){h=a(".fusion-builder-demo-select").val(),a("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),a("#fusion-builder-layouts-demos .demo-"+h).show()}),b.live("click",function(b){var c;b.preventDefault(),a(this).find("i").attr("class"),c=a(this).find("i").attr("data-name"),a(this).hasClass("selected-element")?(a(this).find("i").parent().parent().find(".selected-element").removeClass("selected-element"),a(this).find("i").parent().parent().parent().find(".fusion-iconpicker-input").attr("value","").trigger("change")):(a(this).find("i").parent().parent().find(".selected-element").removeClass("selected-element"),a(this).find("i").parent().addClass("selected-element"),a(this).find("i").parent().parent().parent().find(".fusion-iconpicker-input").attr("value",c).trigger("change"))}),a("#qt_content_fusion_shortcodes_text_mode, #qt_excerpt_fusion_shortcodes_text_mode").live("click",function(){openShortcodeGenerator(a(this))}),a("#new_template_name").keydown(function(a){return 13!=a.keyCode||(a.preventDefault(),a.stopPropagation(),FusionPageBuilderEvents.trigger("fusion-save-layout"),!1)}),a("body").on("keydown","#fusion-builder-save-element-input",function(b){return 13!=b.keyCode||(b.preventDefault(),b.stopPropagation(),a(".fusion-builder-element-button-save").trigger("click"),!1)})})}(jQuery),function(a){fusionBuilderInsertIntoEditor=function(b,c){var d,e;window.SCmoduleContentEditorMode
;"tinymce"!==window.SCmoduleContentEditorMode||""!==c&&void 0!==c?(d=a(null===c||""===c||void 0===c?window.editorArea:"#"+c),"excerpt"===d.attr("id")&&(FusionPageBuilderApp.fromExcerpt=!0),void 0===window.cursorPosition?0===d.getCursorPosition()?d.val(b+d.val()):d.val().length===d.getCursorPosition()?d.val(d.val()+b):d.val(d.val().slice(0,d.getCursorPosition())+b+d.val().slice(d.getCursorPosition())):d.val([d.val().slice(0,window.cursorPosition),b,d.val().slice(window.cursorPosition)].join(""))):void 0!==window.tinyMCE&&(e=FusionPageBuilderApp.shortcodeGeneratorActiveEditor,e.focus(),"excerpt"===e.id&&(FusionPageBuilderApp.fromExcerpt=!0),window.tinyMCE.activeEditor.execCommand("mceInsertContent",!1,b),window.tinyMCE.activeEditor.execCommand("mceCleanup",!1)),!1===FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGeneratorActiveEditor="")}}(jQuery),function(a,b){a.fn.getCursorPosition=function(){var b,c,d=a(this).get(0),e=0;return"selectionStart"in d?e=d.selectionStart:"selection"in document&&(d.focus(),b=document.selection.createRange(),c=document.selection.createRange().text.length,b.moveStart("character",-d.value.length),e=b.text.length-c),e}}(jQuery),function(a){var b={},c=new Array("[]"),d=new Array("[]"),e=0;window.tracking="on",window.fusionHistoryState="",window.fusionHistoryManager=b,b.captureEditor=function(){var f;b.isTrackingOn()&&(25==e?c.shift():e+=1,e>1&&(a(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),a(".fusion-builder-history-list").prepend('<li data-state-id="'+e+'" class="history-state-'+e+' fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionHistoryState+"</li>")),f=fusionBuilderGetContent("content",!0),c[e]=f,d[e]=fusionHistoryState,b.updateButtons(),fusionHistoryState="")},b.turnOnTracking=function(){window.tracking="on"},b.turnOffTracking=function(){window.tracking="off"},b.doUndo=function(d){var f;d&&d.preventDefault(),b.hasUndo()&&(b.turnOffTracking(),e-=1,f=c[e],"[]"!==f&&(FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(f),a(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),a(".fusion-builder-history-list").find(".history-state-"+e).addClass("fusion-history-active-state")),b.updateButtons())},b.doRedo=function(d){var f;d&&d.preventDefault(),b.hasRedo()&&(b.turnOffTracking(),e+=1,f=c[e],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(f),b.updateButtons(),a(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),a(".fusion-builder-history-list").find(".history-state-"+e).addClass("fusion-history-active-state"))},b.historyStep=function(d,f){var g;f&&f.preventDefault(),g=c[d],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(g),e=d,b.updateButtons(),a(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),a(".fusion-builder-history-list").find(".history-state-"+e).addClass("fusion-history-active-state")},b.isTrackingOn=function(){return"on"===window.tracking},b.logStacks=function(){},b.clearEditor=function(f){var g;c=new Array("[]"),d=new Array("[]"),e=1,fusionHistoryState="","blank"===f?c[e]="":(g=fusionBuilderGetContent("content",!0),c[e]=g),b.updateButtons(),a(".fusion-builder-history-list").html('<li data-state-id="1" class="history-state-1 fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionBuilderText.empty+"</li>")},b.hasUndo=function(){return 1!==e},b.hasRedo=function(){return e<c.length-1},b.getCommands=function(){return c},b.updateButtons=function(){b.hasUndo()?(a(".fusion-builder-layout-buttons-undo").addClass("fusion-history-has-step"),a(".fusion-builder-layout-buttons-history").addClass("fusion-history-has-step")):(a(".fusion-builder-layout-buttons-undo").removeClass("fusion-history-has-step"),a(".fusion-builder-layout-buttons-history").removeClass("fusion-history-has-step")),b.hasRedo()?a(".fusion-builder-layout-buttons-redo").addClass("fusion-history-has-step"):a(".fusion-builder-layout-buttons-redo").removeClass("fusion-history-has-step")}}(jQuery);